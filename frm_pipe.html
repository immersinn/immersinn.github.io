<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="TRII" />
    <meta name="generator" content="Pelican (VoidyBootstrap theme)" />

    <title>NLP Pipelines with spaCy: Filter &amp; Replace &amp; Map - immersinn-ds</title>

   
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />  



    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="./favicon.ico" />
        <link href="http://immersinn.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="immersinn-ds Atom Feed" />
  </head>

  <body>
   
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
	   <div class="navbar-header">
		<button type="button" class="navbar-toggle" 
				data-toggle="collapse" data-target="#main-navbar-collapse">
		  <span class="sr-only">Toggle navigation</span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="./" rel="home">
          <i class="fa fa-home fa-fw fa-lg"> </i> </a>
       </div>

      <div class="collapse navbar-collapse" id="main-navbar-collapse">
        <ul class="nav navbar-nav">
            <li class="divider"></li>
            <li class="">
              <a href="./archives.html">Archives</a>
            </li>
          <li class="divider"></li>
            <li><a href="http://immersinn.github.io/feeds/all.atom.xml" 
                   type="application/atom+xml" rel="alternate">
                <i class="fa fa-rss fa-fw fa-lg"></i> </a></li>
        </ul> <!-- /nav -->
      </div> <!-- /navbar-collapse -->
	  </div> <!-- /container -->
    </nav> <!-- /navbar -->

	<div class="jumbotron" id="overview">
	  <div class="container">
		<h1><a href="./">immersinn-ds</a></h1>
	  </div>
	</div>

    <div class="container" id="main-container">
        <div class="" id="content">
<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
<abbr class="article-header-date">
  Mon 12 December 2016
</abbr> <h1>
  <a href="./frm_pipe.html" rel="bookmark"
     title="Permalink to NLP Pipelines with spaCy: Filter &amp; Replace &amp; Map">
    NLP Pipelines with spaCy: Filter & Replace & Map
  </a>
</h1><div class="article-header-info">
  <p>
      Posted by <a href="./author/trii.html">TRII</a>
    in 
    <a href="./category/text-analytics.html">
      text-analytics</a>
    &nbsp;&nbsp;
  </p>
</div> <!-- /.article-header-info -->  </header>
  <div class="content-body" itemprop="text articleBody">
	<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
@-moz-document url-prefix() {
  div.inner_cell {
    overflow-x: hidden;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction-/-Overview">Introduction / Overview<a class="anchor-link" href="#Introduction-/-Overview">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A semi-hasty post :-)</p>
<p>As a semi-follow up to the <a href="https://immersinn.github.io/okapi-bm25.html">previous article</a>, we expand upon the pipeline to build out some custom steps that we use for generating word contexts.  spaCy documents lock token attributes, so it is a bit difficult to filter and replace tokens directly.  Here, we build some custom "dummy" Token and Document classes that mimic basic functionality of spaCy Tokens and Documents while still being able to link back to the vocabulary (or generate a custom one).</p>
<p>Additionally, we make use of textacy for some document pre-pre-processing, like replacing numbers / digits with text (i.e., "*number*").  To steps of the pipeline used in this article are shown below.  The code referenced by several of the steps below, along with some other not so useful stuff, <a href="https://github.com/immersinn/text_analytics">is here</a> in the (not so well named) "vocab_customizer" file.</p>
<p>Pipeline:</p>
<ol>
<li>Pre-process raw text with textacy<ul>
<li>Replace contractions with "full" format</li>
<li>Replace numbers with common representation</li>
<li>Replace emails with common representation</li>
<li>Replace currency symbols with acronyms</li>
</ul>
</li>
<li>Convert raw text to spaCy docs<ul>
<li>Only use "tagger" and "parser"</li>
</ul>
</li>
<li>Filter, Replace, Map:<ol>
<li>Filter out unwanted tokens / lexeme<ul>
<li>Remove non-alpha-like characters</li>
<li>Remove stopwords</li>
</ul>
</li>
<li>Replace infrequent tokens<ul>
<li>Replace infrequent words with POS tags or some other representative symbols</li>
</ul>
</li>
<li>Map<ul>
<li>Convert the token keys to a shortened list; i.e., the size of the new vocab will be the number of unique token keys observed, not the total number in the spaCy nlp pipeline vocabulary</li>
</ul>
</li>
</ol>
</li>
<li>Get Word Contexts from Documents' Sentences</li>
</ol>
<p>Our implementation is currently a bit of a "loose" pipeline in that the textacy preprocessing and spaCy transformation steps are "hand coded" to an extent, and there is no code that tracks the overall process of the complete pipe.  Such a wrapper may be constructed at a later date if it seems beneficial for future endeavors.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">itertools</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Counter</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">importlib</span> <span class="k">import</span> <span class="n">reload</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">spacy</span>
<span class="kn">from</span> <span class="nn">spacy</span> <span class="k">import</span> <span class="n">attrs</span>
<span class="kn">import</span> <span class="nn">textacy</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">"whitegrid"</span><span class="p">,</span> <span class="n">color_codes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">importlib</span> <span class="k">import</span> <span class="n">reload</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Load-Articles">Load Articles<a class="anchor-link" href="#Load-Articles">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-data-stuffs">Load data stuffs<a class="anchor-link" href="#Load-data-stuffs">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>cd ..</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'Text Retrieval and Search Engines/data/preprocessedArticleContentDump.pkl'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">articles</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cd</span> <span class="n">Text</span>\ <span class="n">Mining</span>\ <span class="ow">and</span>\ <span class="n">Analytics</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/immersinn/Dropbox/Analytics/Text Mining and Analytics
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">articles</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[10]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>URL</th>
<th>category</th>
<th>content</th>
<th>source</th>
<th>title</th>
<th>tokenized</th>
<th>bow</th>
<th>tot_len</th>
<th>unique_words</th>
<th>title_bow</th>
<th>doc_id</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>http://phys.org/news/2016-04-activists-appeal-...</td>
<td>earth-news</td>
<td>Environmental groups on Tuesday lodged a compl...</td>
<td>PhysOrg</td>
<td>Activists appeal to EU over Polish logging of ...</td>
<td>[environmental, groups, on, tuesday, lodged, a...</td>
<td>{firs, protests, blocks, in, received, what, a...</td>
<td>385</td>
<td>223</td>
<td>{logging, activists, primeval, polish, to, of,...</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>http://phys.org/news/2016-04-seismic-ecuador.html</td>
<td>earth-news</td>
<td>A doctoral thesis developed at UPM analysed th...</td>
<td>PhysOrg</td>
<td>The seismic risk of Ecuador</td>
<td>[a, doctoral, thesis, developed, at, upm, anal...</td>
<td>{in, february, cárdenas, director, benito, wit...</td>
<td>269</td>
<td>152</td>
<td>{the, risk, ecuador, seismic, of}</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Text-to-Word-Contexts">Text to Word Contexts<a class="anchor-link" href="#Text-to-Word-Contexts">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we take each of the steps in the pipeline and carry out that task.  The first two steps -- preprocess with textacy and create spaCy docs -- are fairly straightforward.</p>
<p>The components of the third step (Filter, Replace, Map) are covered separately first and then all together.  The code shown directly in this file only covers some of the process.  For the full code, see the GitHub repository referenced in the Intro.</p>
<p>A basic version of the last step -- create word contexts-- was seen previously.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preprocess-Texts-with-Textacy">Preprocess Texts with Textacy<a class="anchor-link" href="#Preprocess-Texts-with-Textacy">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Does what it says.  There are several more options for things that can be removed / replaced (e.g. punctuation), but the set of items shown below were sufficient for our purposes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">textacy_preprocessor</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">text</span><span class="p">:</span> <span class="n">textacy</span><span class="o">.</span><span class="n">preprocess</span><span class="o">.</span><span class="n">preprocess_text</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> 
                                                                       <span class="n">no_contractions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                                       <span class="n">no_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                                       <span class="n">no_emails</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                                       <span class="n">no_currency_symbols</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">docs</span> <span class="o">=</span> <span class="p">[</span><span class="n">textacy_preprocessor</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">articles</span><span class="o">.</span><span class="n">content</span><span class="p">)[:</span><span class="mi">500</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="spaCy-Pipeline">spaCy Pipeline<a class="anchor-link" href="#spaCy-Pipeline">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Essentially as shown in the previous article.  We do not load the word vectors to save some space / time because we do not need them.  Additionally, we truncate the pipeline to only Tagging and Parsing, as we do not need anything else for this particular exercise.  These two steps also would allow for using Noun Phrases as Tokens in our Vocabulary / Word Documents below if we were so inclined.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">"en"</span><span class="p">,</span> <span class="n">add_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nlp</span><span class="o">.</span><span class="n">pipeline</span> <span class="o">=</span> <span class="p">[</span><span class="n">nlp</span><span class="o">.</span><span class="n">tagger</span><span class="p">,</span> <span class="n">nlp</span><span class="o">.</span><span class="n">parser</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spacy_docs</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">n_threads</span><span class="o">=</span><span class="mi">4</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Filter,-Replace,-Map">Filter, Replace, Map<a class="anchor-link" href="#Filter,-Replace,-Map">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">text_analytics</span> <span class="k">import</span> <span class="n">vocab_customizer</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the <a href="https://immersinn.github.io/spaCy_firsts.html">previous post dealing with spaCy</a>, an example of a vocabulary customizer class was shown.  We now use an updated and modified version of that example to generate a restricted vocabulary for our data.  As mentioned above, the code used can be found <a href="https://github.com/immersinn/text_analytics">here</a>.  Each of the classes follows a scikit-learn style of "fit" and "transform", though this model is not entirely appropriate.  Typically we will not be looking at documents outside of the original document set for this particular pipeline.  Additionally functionality would be needed to account for this.  For instance, we would need to cover the case of encountering unseen tokens.</p>
<p>First, we Filter out words we do not want to have in our vocabulary.  For this example, we use a subset of the NLTK English Stopwords list.  Notice that we add back in pronouns, prepositions, and verbs, as well as the possessive "ending", "'s".  For finding Paradigmatic and Syntagmatic similarities, we feel that these tokens may be important.</p>
<p>Our second step is to Replace a subset of the vocabulary.  Specifically, we replace words that appear in a small number of documents (original documents, not word documents) with the respective Part of Speech (POS) Tag for the Token.  Note that we do not necessarily replace all occurrences of an infrequent word with the same POS Tag.  Instead, we look at each occurrence of that Token and replace each instance of the Token with the respective POS Tag assigned to it by spaCy.  Also note that we do not look at the total frequency of words, but the Document Frequency.  This step removes a number of peoples' names, as well as infrequent words in general.</p>
<p>The third step takes our now Filtered and Replaced documents and creates a mapping between consecutive integers and the spaCy lemmas associated with the Tokens (POS tags are assigned to lemmas in the spaCy vocabulary as well).  This allows for a compact representation of the remaining tokens in the documents, which enables us to easily map the words, documents, and word-documents to a set of indices for referencing a matrix (array).</p>
<p>Additionally, we only construct contexts and Word-Documents for words that were neither filtered nor replaced, nor were the resulting mapping for a replaced word (i.e. no Word Documents are constructed for POS Tags).  This means we need an additional mapping from our truncated vocabulary to the Word-Document Identifiers.  We cover this step below as well.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Filter">Filter<a class="anchor-link" href="#Filter">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">custom_stop_words</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">corpus</span><span class="o">.</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">'english'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stops_to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'i'</span><span class="p">,</span> <span class="s1">'me'</span><span class="p">,</span> <span class="s1">'we'</span><span class="p">,</span> <span class="s1">'you'</span><span class="p">,</span> <span class="s1">'he'</span><span class="p">,</span> <span class="s1">'him'</span><span class="p">,</span> <span class="s1">'himself'</span><span class="p">,</span> <span class="s1">'she'</span><span class="p">,</span> <span class="s1">'her'</span><span class="p">,</span> <span class="s1">'herself'</span><span class="p">,</span>
                   <span class="s1">'it'</span><span class="p">,</span> <span class="s1">'itself'</span><span class="p">,</span> <span class="s1">'they'</span><span class="p">,</span> <span class="s1">'them'</span><span class="p">,</span> <span class="s1">'themselves'</span><span class="p">,</span>
                   <span class="s1">'ourselves'</span><span class="p">,</span> <span class="s1">'yourselves'</span>
                   <span class="s1">'about'</span><span class="p">,</span> <span class="s1">'against'</span><span class="p">,</span> <span class="s1">'between'</span><span class="p">,</span> <span class="s1">'into'</span><span class="p">,</span> <span class="s1">'through'</span><span class="p">,</span>
                   <span class="s1">'during'</span><span class="p">,</span> <span class="s1">'before'</span><span class="p">,</span> <span class="s1">'after'</span><span class="p">,</span> <span class="s1">'above'</span><span class="p">,</span> <span class="s1">'below'</span><span class="p">,</span>
                   <span class="s1">'to'</span><span class="p">,</span> <span class="s1">'from'</span><span class="p">,</span> <span class="s1">'up'</span><span class="p">,</span> <span class="s1">'down'</span><span class="p">,</span> <span class="s1">'in'</span><span class="p">,</span> <span class="s1">'out'</span><span class="p">,</span> <span class="s1">'on'</span><span class="p">,</span> <span class="s1">'off'</span><span class="p">,</span>
                   <span class="s1">'over'</span><span class="p">,</span> <span class="s1">'under'</span><span class="p">,</span> <span class="s1">'again'</span><span class="p">,</span> <span class="s1">'further'</span><span class="p">,</span>
                   <span class="s1">'has'</span><span class="p">,</span> <span class="s1">'had'</span><span class="p">,</span> <span class="s1">'having'</span><span class="p">,</span> 
                   <span class="s1">'am'</span><span class="p">,</span> <span class="s1">'is'</span><span class="p">,</span> <span class="s1">'are'</span><span class="p">,</span> <span class="s1">'was'</span><span class="p">,</span> <span class="s1">'were'</span><span class="p">,</span> <span class="s1">'will'</span><span class="p">,</span> <span class="s1">'can'</span><span class="p">,</span>
                   <span class="s1">'be'</span><span class="p">,</span> <span class="s1">'been'</span><span class="p">,</span> <span class="s1">'being'</span><span class="p">,</span>
                   <span class="s1">'have'</span><span class="p">,</span> <span class="s1">'has'</span><span class="p">,</span> <span class="s1">'had'</span><span class="p">,</span> <span class="s1">'having'</span><span class="p">,</span>
                   <span class="s1">'do'</span><span class="p">,</span> <span class="s1">'does'</span><span class="p">,</span> <span class="s1">'did'</span><span class="p">,</span> <span class="s1">'doing'</span><span class="p">,</span>
                   
                   <span class="s2">"'s"</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">custom_stop_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">custom_stop_words</span> <span class="k">if</span> <span class="n">w</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stops_to_remove</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we set the list of custom stopwords we want to use.  First, we need to un-flag all default stopwords in the spaCy vocabulary.  Then, all words in the custom list are flagged as stops in the spaCy vocabulary.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Remove existing stopwords...</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">Defaults</span><span class="o">.</span><span class="n">stop_words</span><span class="p">:</span>
    <span class="n">lexeme</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
    <span class="n">lexeme</span><span class="o">.</span><span class="n">is_stop</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">lexeme</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
    <span class="n">lexeme</span><span class="o">.</span><span class="n">is_stop</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># and set custom stopwords...</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">custom_stop_words</span><span class="p">:</span>
    <span class="n">lexeme</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
    <span class="n">lexeme</span><span class="o">.</span><span class="n">is_stop</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">lexeme</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
    <span class="n">lexeme</span><span class="o">.</span><span class="n">is_stop</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lex_filter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">vocab_customizer</span><span class="o">.</span><span class="n">lexeme_filter</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> 
                                                      <span class="n">filter_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                      <span class="n">filter_digit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                      <span class="n">filter_like_num</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                      <span class="n">filter_short</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filter01</span> <span class="o">=</span> <span class="n">vocab_customizer</span><span class="o">.</span><span class="n">TokenFilter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">documents</span> <span class="o">=</span> <span class="p">[</span><span class="n">vocab_customizer</span><span class="o">.</span><span class="n">DummyDoc</span><span class="p">([[</span><span class="n">vocab_customizer</span><span class="o">.</span><span class="n">DummyToken</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">]</span> \
                                        <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">])</span> \
             <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">spacy_docs</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span> <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">documents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sents</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[26]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>[32, 49, 31, 49, 52, 26, 37, 21, 34, 20, 14, 4, 32, 46, 45, 1, 4]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filter01</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>
<span class="n">filter01</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span> <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">documents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sents</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[28]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>[22, 32, 20, 34, 31, 14, 24, 12, 22, 13, 11, 2, 18, 26, 21, 0, 2]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Replace">Replace<a class="anchor-link" href="#Replace">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">min_freq</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">replace_attr</span> <span class="o">=</span> <span class="s1">'pos'</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">key_2_attr_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'lower'</span> <span class="p">:</span> <span class="n">attrs</span><span class="o">.</span><span class="n">LOWER</span><span class="p">,</span>
                  <span class="s1">'orth'</span> <span class="p">:</span> <span class="n">attrs</span><span class="o">.</span><span class="n">ORTH</span><span class="p">,</span>
                  <span class="s1">'pos'</span> <span class="p">:</span> <span class="n">attrs</span><span class="o">.</span><span class="n">POS</span><span class="p">,}</span>

<span class="n">kem</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">vocab_customizer</span><span class="o">.</span><span class="n">count_by_transform</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">key_2_attr_map</span><span class="p">[</span><span class="s1">'lower'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">docs_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">kem</span><span class="p">(</span><span class="n">document</span><span class="p">)</span> <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="n">spacy_docs</span><span class="p">]</span>
          
<span class="c1"># Count total documents each key occurs in</span>
<span class="n">doc_frequency</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">doc_keys</span> <span class="ow">in</span> <span class="n">docs_keys</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">doc_keys</span><span class="p">:</span>
        <span class="n">doc_frequency</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">ift</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">doc_frequency</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span> <span class="o"><</span> <span class="n">min_freq</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">replace_func</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">ift</span><span class="p">,</span> <span class="n">replace_attr</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">key_attr</span> <span class="ow">in</span> <span class="n">ift</span><span class="p">:</span>
        <span class="n">token</span><span class="o">.</span><span class="n">key_attr</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="n">replace_attr</span><span class="p">)</span>
        
<span class="n">token_replace</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">replace_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ift</span><span class="p">,</span> <span class="n">replace_attr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">replace01</span> <span class="o">=</span> <span class="n">vocab_customizer</span><span class="o">.</span><span class="n">TokenReplaceInfrequent</span><span class="p">(</span><span class="n">min_freq</span><span class="o">=</span><span class="n">min_freq</span><span class="p">,</span> <span class="n">token_replace_attr</span><span class="o">=</span><span class="n">replace_attr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">documents</span> <span class="o">=</span> <span class="p">[</span><span class="n">vocab_customizer</span><span class="o">.</span><span class="n">DummyDoc</span><span class="p">([[</span><span class="n">vocab_customizer</span><span class="o">.</span><span class="n">DummyToken</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">]</span> \
                                        <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">])</span> \
             <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">spacy_docs</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">documents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sents</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">prt_wrds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="n">w</span><span class="o">.</span><span class="n">key_attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">[:</span><span class="mi">7</span><span class="p">]]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prt_wrds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[('environmental', 7091), ('groups', 1924), ('on', 485), ('tuesday', 20152), ('lodged', 32735), ('a', 469), ('complaint', 5183)]
[('"', 481), ('we', 535), ('risk', 1568), ('turning', 2539), ('this', 496), ('forest', 5699), ('into', 586)]
[('poland', 46560), ("'s", 478), ('environment', 2376), ('minister', 11907), ('jan', 51381), ('szyszko', 1510247), ('last', 691)]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">replace01</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>
<span class="n">replace01</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">documents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sents</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">prt_wrds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="n">w</span><span class="o">.</span><span class="n">key_attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">[:</span><span class="mi">7</span><span class="p">]]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prt_wrds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[('environmental', 7091), ('groups', 1924), ('on', 485), ('tuesday', 20152), ('lodged', 97), ('a', 469), ('complaint', 89)]
[('"', 481), ('we', 535), ('risk', 1568), ('turning', 2539), ('this', 496), ('forest', 89), ('into', 586)]
[('poland', 93), ("'s", 478), ('environment', 2376), ('minister', 93), ('jan', 93), ('szyszko', 93), ('last', 691)]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">id_</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">89</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">97</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"ID: </span><span class="si">{}</span><span class="s2">; POS: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">id_</span><span class="p">,</span> <span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">id_</span><span class="p">]</span><span class="o">.</span><span class="n">lower_</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>ID: 89; POS: noun
ID: 93; POS: propn
ID: 97; POS: verb
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Map">Map<a class="anchor-link" href="#Map">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">documents</span> <span class="o">=</span> <span class="p">[</span><span class="n">vocab_customizer</span><span class="o">.</span><span class="n">DummyDoc</span><span class="p">([[</span><span class="n">vocab_customizer</span><span class="o">.</span><span class="n">DummyToken</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">]</span> \
                                        <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">])</span> \
             <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">spacy_docs</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">documents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sents</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">prt_wrds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="n">w</span><span class="o">.</span><span class="n">key_attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">[:</span><span class="mi">7</span><span class="p">]]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prt_wrds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[('environmental', 7091), ('groups', 1924), ('on', 485), ('tuesday', 20152), ('lodged', 32735), ('a', 469), ('complaint', 5183)]
[('"', 481), ('we', 535), ('risk', 1568), ('turning', 2539), ('this', 496), ('forest', 5699), ('into', 586)]
[('poland', 46560), ("'s", 478), ('environment', 2376), ('minister', 11907), ('jan', 51381), ('szyszko', 1510247), ('last', 691)]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">unit</span> <span class="o">=</span> <span class="s2">"sents"</span>
<span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">documents</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">unit</span><span class="o">==</span><span class="s2">"sents"</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">key_attr</span> <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">unit</span><span class="o">==</span><span class="s2">"words"</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">key_attr</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">]</span>
    <span class="n">vocab_keys</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_encoding</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vocab_keys</span><span class="p">)}</span>
<span class="n">rev_vocab_encoding</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="n">vocab_encoding</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="n">vocab</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="p">:</span> <span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">rev_vocab_encoding</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> \
         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vocab_encoding</span><span class="o">.</span><span class="n">values</span><span class="p">()}</span>

<span class="n">word_lookup</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="p">:</span> <span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="n">rev_vocab_encoding</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">lower_</span> \
               <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">vocab_encoding</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [43]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">encode_word</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
    <span class="n">token</span><span class="o">.</span><span class="n">key_attr</span> <span class="o">=</span> <span class="n">vocab_encoding</span><span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">key_attr</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">encode_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">unit</span><span class="o">==</span><span class="s2">"sents"</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">:</span>
                <span class="n">encode_word</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">unit</span><span class="o">==</span><span class="s2">"words"</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">tokens</span><span class="p">:</span>
            <span class="n">encode_word</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">encode_docs</span><span class="p">(</span><span class="n">docs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">documents</span><span class="p">:</span>
        <span class="n">encode_doc</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encode_docs</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">documents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sents</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">prt_wrds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="n">w</span><span class="o">.</span><span class="n">key_attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">[:</span><span class="mi">7</span><span class="p">]]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prt_wrds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[('environmental', 6686), ('groups', 1581), ('on', 175), ('tuesday', 15118), ('lodged', 19967), ('a', 159), ('complaint', 4789)]
[('"', 171), ('we', 225), ('risk', 1238), ('turning', 2169), ('this', 186), ('forest', 5305), ('into', 276)]
[('poland', 11467), ("'s", 168), ('environment', 2011), ('minister', 10251), ('jan', 14327), ('szyszko', 2526), ('last', 379)]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Filter-&amp;-Replace-&amp;-Map">Filter & Replace & Map<a class="anchor-link" href="#Filter-&amp;-Replace-&amp;-Map">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we throw the previous three steps together into as single transformation object.  This object tracks the entire process and allows us to trace encodings back to words for those words that were not replaced.  Replaced words are inherently "lost" in the replacement process because it is possible for multiple tokens to be encoded to the same token during the replace process.</p>
<p>For comparison, we show the original spaCy version and the processed version for the first document in the collection.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vm</span> <span class="o">=</span> <span class="n">vocab_customizer</span><span class="o">.</span><span class="n">VocabPrep</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">stopwords</span><span class="o">=</span><span class="n">custom_stop_words</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">spacy_docs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">spacy_docs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sents</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">))</span>
    <span class="n">prt_snt</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">lex_id</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prt_snt</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">([</span><span class="n">w</span><span class="o">.</span><span class="n">lower_</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">][:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>32
[28656, 1467, 22, 5629, 32314, 6, 4734, 26, 3, 2753]
['environmental', 'groups', 'on', 'tuesday', 'lodged', 'a', 'complaint', 'with', 'the', 'european']
49
[18, 193, 1109, 2082, 33, 5252, 124, 6, 1950, 35261]
['"', 'we', 'risk', 'turning', 'this', 'forest', 'into', 'a', 'tree', 'plantation']
31
[8013, 15, 36042, 12393, 12690, 0, 230, 618, 682, 3]
['poland', "'s", 'environment', 'minister', 'jan', 'szyszko', 'last', 'month', 'gave', 'the']
49
[54, 18909, 11, 1941, 50, 3, 1503, 1191, 8, 3]
['the', 'commission', 'is', 'concerned', 'about', 'the', 'recent', 'decision', 'of', 'the']
52
[5804, 3, 190, 783, 2, 66193, 71, 10777, 66, 93]
['under', 'the', 'new', 'plan', ',', 'loggers', 'will', 'harvest', 'more', 'than']
26
[54, 41488, 166, 447, 26, 3, 489, 15, 14136, 2]
['the', 'environmentalists', 'take', 'issue', 'with', 'the', 'government', "'s", 'rationale', ',']
37
[18, 19677, 5, 61, 3, 11466, 8, 1919, 420, 2]
['"', 'contrary', 'to', 'what', 'the', 'minister', 'of', 'environment', 'says', ',']
21
[54, 1467, 171, 3, 9197, 783, 2, 125, 100, 1727]
['the', 'groups', 'said', 'the', 'logging', 'plan', ',', 'which', 'could', 'begin']
34
[18, 193, 48, 30, 2164, 33, 1191, 415, 10182, 675]
['"', 'we', 'can', 'not', 'challenge', 'this', 'decision', 'under', 'polish', 'law']
20
[18, 222, 3, 524, 2, 40192, 8, 2522, 1376, 675]
['"', 'in', 'the', 'past', ',', 'breaches', 'of', 'eu', 'nature', 'law']
14
[193, 363, 3, 11466, 71, 12346, 170, 33, 39343, 5252]
['we', 'hope', 'the', 'minister', 'will', 'reconsider', 'before', 'this', 'irreplaceable', 'forest']
4
[18, 326403, 863, 23]
['"', 'sprawling', 'across', '*']
32
[31202, 23, 99278, 43, 173, 23, 31202, 23, 19108, 24]
['number', '*', 'hectares', '(', 'around', '*', 'number', '*', 'acres', ')']
46
[78855, 6, 84861, 1755, 25621, 770, 14, 23, 31202, 23]
['designated', 'a', 'unesco', 'world', 'heritage', 'site', 'in', '*', 'number', '*']
45
[1749, 15, 23942, 2648, 2, 78085, 46382, 23, 31202, 23]
['europe', "'s", 'tallest', 'trees', ',', 'firs', 'towering', '*', 'number', '*']
1
[69433]
['©']
4
[23, 31202, 23, 64878]
['*', 'number', '*', 'afp']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_docs</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">spacy_docs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">new_docs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sents</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sent</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">([</span><span class="n">vm</span><span class="o">.</span><span class="n">vocab2word</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">][:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>22
[2310, 1023, 63, 1727, 16, 11, 1724, 14, 138, 14]
['environmental', 'groups', 'on', 'tuesday', 'verb', 'noun', 'european', 'propn', 'over', 'propn']
32
[95, 814, 1304, 11, 127, 11, 11, 2277, 902, 1094]
['we', 'risk', 'turning', 'noun', 'into', 'noun', 'noun', 'reducing', 'natural', 'heritage']
20
[14, 1234, 14, 14, 14, 208, 501, 545, 120, 936]
['propn', 'environment', 'propn', 'propn', 'propn', 'last', 'month', 'gave', 'go', 'ahead']
34
[14, 60, 16, 1045, 863, 4, 19, 1423, 1234, 11]
['propn', 'is', 'verb', 'recent', 'decision', 'adj', 'authorities', 'eu', 'environment', 'noun']
31
[352, 177, 620, 11, 93, 16, 47, 4, 11, 47]
['under', 'new', 'plan', 'noun', 'will', 'verb', 'number', 'adj', 'noun', 'number']
14
[11, 159, 380, 416, 11, 238, 4, 11, 11, 60]
['noun', 'take', 'issue', 'government', 'noun', 'saying', 'adj', 'noun', 'noun', 'is']
24
[4, 56, 11, 1234, 355, 11, 11, 11, 106, 16]
['adj', 'to', 'noun', 'environment', 'says', 'noun', 'noun', 'noun', 'does', 'verb']
12
[1023, 163, 11, 620, 109, 1144, 529, 11, 16, 1423]
['groups', 'said', 'noun', 'plan', 'could', 'begin', 'early', 'noun', 'verb', 'eu']
22
[95, 75, 1333, 863, 352, 4, 539, 16, 56, 14]
['we', 'can', 'challenge', 'decision', 'under', 'adj', 'law', 'verb', 'to', 'propn']
13
[61, 439, 11, 1423, 979, 539, 62, 1539, 56, 4]
['in', 'past', 'noun', 'eu', 'nature', 'law', 'have', 'led', 'to', 'adj']
11
[95, 307, 11, 93, 16, 162, 4, 11, 60, 471]
['we', 'hope', 'noun', 'will', 'verb', 'before', 'adj', 'noun', 'is', 'lost']
2
[16, 668]
['verb', 'across']
18
[47, 11, 165, 47, 11, 14, 11, 16, 138, 4]
['number', 'noun', 'around', 'number', 'noun', 'propn', 'noun', 'verb', 'over', 'adj']
26
[16, 14, 244, 1094, 609, 61, 47, 11, 60, 327]
['verb', 'propn', 'world', 'heritage', 'site', 'in', 'number', 'noun', 'is', 'home']
21
[1122, 4, 1500, 6, 16, 47, 11, 259, 47, 975]
['europe', 'adj', 'trees', 'adv', 'verb', 'number', 'noun', 'high', 'number', 'feet']
2
[47, 1723]
['number', 'afp']
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vm</span><span class="o">.</span><span class="n">n_words</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[51]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>2428</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [52]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vm</span><span class="o">.</span><span class="n">n_total</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[52]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>2441</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Generate-Word-Documents-From-Word-Contexts">Generate Word Documents From Word Contexts<a class="anchor-link" href="#Generate-Word-Documents-From-Word-Contexts">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For determining Paradigmatic and Syntagmatic relationships, a document is generated for each word of interest in the vocabulary.  The "word document" is constructed from all word contexts within the corpus of interest.  From each sentence a particular word occurs in, a context is extracted.  This is typically some window around the word, consisting of other words that are observed both before and after the target word.  All contexts for the word are combined to construct a single BOW document for the word.</p>
<p>As a note, we only find contexts and construct Word Documents for words that were neither filtered out nor replaced.  Thus, at this step, we need an additional mapping between the vocab and the documents.  Word Documents are simply numbered from 1 to the total number of Word Documents.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-Word-Docs-TDM">Generate Word Docs TDM<a class="anchor-link" href="#Generate-Word-Docs-TDM">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [187]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">symWindowContext</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">sent</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">context</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sent</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">target</span><span class="o">-</span><span class="n">window_size</span><span class="p">):</span><span class="n">target</span><span class="p">])</span> <span class="o">+</span> \
    <span class="nb">list</span><span class="p">(</span><span class="n">sent</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">),</span><span class="n">target</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">),</span> <span class="p">(</span><span class="n">target</span><span class="o">+</span><span class="n">window_size</span><span class="o">+</span><span class="mi">1</span><span class="p">))])</span>
    <span class="k">return</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">contextGen</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">wcc</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">cutoff_len</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span> <span class="o">></span> <span class="n">cutoff_len</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sent</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">vocab</span><span class="p">:</span>
                    <span class="n">context</span> <span class="o">=</span> <span class="n">symWindowContext</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">sent</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="n">ws</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
                        <span class="n">wcc</span><span class="p">[</span><span class="n">word</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span><span class="p">(</span><span class="n">wcc</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">wordBOWGenerator</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    
    <span class="c1"># Each word is a "document"</span>
    <span class="n">word_bows</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span> <span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">vocab</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
        <span class="n">word_bows</span> <span class="o">=</span> <span class="n">contextGen</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span>
                               <span class="n">word_bows</span><span class="p">,</span>
                               <span class="n">ws</span><span class="o">=</span><span class="n">window_size</span><span class="p">)</span>
    <span class="c1"># "Lock" the defaultdicts</span>
    <span class="n">word_bows</span> <span class="o">=</span> <span class="p">{</span><span class="n">w</span> <span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">word_bows</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">word_bows</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">contextMatrixGenerator</span><span class="p">(</span><span class="n">word_docs</span><span class="p">,</span> <span class="n">n_docs</span><span class="p">,</span> <span class="n">n_vocab</span><span class="p">):</span>
    
    <span class="n">data</span><span class="p">,</span> <span class="n">iii</span><span class="p">,</span> <span class="n">jjj</span> <span class="o">=</span> \
    <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[(</span><span class="n">c</span><span class="p">,</span><span class="n">doc</span><span class="p">[</span><span class="s1">'doc_id'</span><span class="p">],</span><span class="n">w2</span><span class="p">)</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">word_docs</span> <span class="k">for</span> <span class="n">w2</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="s1">'bow'</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
    
    <span class="n">mat</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">iii</span><span class="p">,</span> <span class="n">jjj</span><span class="p">)),</span>
                                  <span class="n">shape</span><span class="o">=</span><span class="p">((</span><span class="n">n_docs</span><span class="p">,</span> <span class="n">n_vocab</span><span class="p">)),</span>
                                  <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [174]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word_bows</span> <span class="o">=</span> <span class="n">wordBOWGenerator</span><span class="p">(</span><span class="n">new_docs</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [179]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word_docs</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">'name'</span><span class="p">:</span><span class="n">w</span><span class="p">,</span> <span class="s1">'bow'</span><span class="p">:</span><span class="n">word_bows</span><span class="p">[</span><span class="n">w</span><span class="p">],</span> <span class="s1">'doc_id'</span><span class="p">:</span><span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">word_bows</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [189]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word_contexts_matrix</span> <span class="o">=</span> <span class="n">contextMatrixGenerator</span><span class="p">(</span><span class="n">word_docs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_docs</span><span class="p">),</span> <span class="n">vm</span><span class="o">.</span><span class="n">n_total</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [193]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word_contexts_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[193]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(2428, 2441)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [127]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sums</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">word_contexts_matrix</span><span class="o">.</span><span class="n">getrow</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> \
                      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">word_contexts_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
<span class="n">sums</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">sums</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [128]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sums</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[128]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>count     2428.000000
mean       124.437397
std        485.552693
min          0.000000
25%         34.000000
50%         54.000000
75%        104.000000
max      15271.000000
dtype: float64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pre-process-T(W)DM-/-Word-Contexts-Matrix-with-BM25">Pre-process T(W)DM / Word Contexts Matrix with BM25<a class="anchor-link" href="#Pre-process-T(W)DM-/-Word-Contexts-Matrix-with-BM25">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For calculating Paradigmatic Similarity Scores we want to use the BM25 method.  To make pairwise similarity calculations more efficient, we can pre-compute the appropriate BM25 word weightings for each document in the collection.  This is similar to the previous <a href="https://immersinn.github.io/okapi-bm25.html">BM25 article</a>.  Weighted term vectors for each Word Document are stacked into a matrix.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [72]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">idfCalc</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">n_vocab</span><span class="p">,</span> <span class="n">n_docs</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"smooth"</span><span class="p">):</span>
    <span class="sd">"""Calculate the idf vector from the vocab"""</span>
    <span class="n">idf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_vocab</span>
                       <span class="p">,))</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">"smooth"</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">w</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">idf</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">n_docs</span> <span class="o">-</span> <span class="n">c</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">))</span>
                        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span><span class="o">==</span><span class="s2">"basic"</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">w</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">idf</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="n">idf</span> <span class="o">/=</span> <span class="n">n_docs</span>
    <span class="k">return</span><span class="p">(</span><span class="n">idf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [61]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">transformBM25</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">idf</span><span class="p">,</span> <span class="n">avgdl</span><span class="p">,</span> <span class="n">k1</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">0.75</span><span class="p">):</span>
    <span class="sd">"""Weight a document BOW vetor based on BM25 methodology"""</span>
    
    <span class="k">def</span> <span class="nf">pdlCalc</span><span class="p">(</span><span class="n">doc_len</span><span class="p">):</span>
        <span class="sd">"""PDL Normalization Calculation"""</span>
        <span class="k">return</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">b</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">doc_len</span> <span class="o">/</span> <span class="n">avgdl</span><span class="p">)</span>
    
    <span class="n">doc_len</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">d_pdl</span> <span class="o">=</span> <span class="n">pdlCalc</span><span class="p">(</span><span class="n">doc_len</span><span class="p">)</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">idf</span> <span class="o">*</span> <span class="p">(</span><span class="n">vec</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">vec</span> <span class="o">+</span> <span class="n">k1</span> <span class="o">*</span> <span class="n">d_pdl</span><span class="p">)</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">vec</span> <span class="o">/</span> <span class="n">vec</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [129]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doc_freqs</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
<span class="k">for</span> <span class="n">bow</span> <span class="ow">in</span> <span class="n">word_bows</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">doc_freqs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bow</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">doc_freqs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">doc_freqs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [130]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idf</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">lil_matrix</span><span class="p">((</span><span class="n">vm</span><span class="o">.</span><span class="n">n_total</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">n_total</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [131]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idf</span><span class="o">.</span><span class="n">setdiag</span><span class="p">(</span><span class="n">idfCalc</span><span class="p">(</span><span class="n">doc_freqs</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">n_total</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">n_words</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [132]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">avgdl</span> <span class="o">=</span> <span class="n">sums</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sums</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [133]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bm25_trans_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">transformBM25</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">idf</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(),</span> <span class="n">avgdl</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [134]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Basic form, with removed '0-context' words</span>
<span class="c1"># May be a better way to loop this?</span>
<span class="n">bm25_vecs</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>\
                                <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">(</span><span class="n">bm25_trans_func</span><span class="p">(</span><span class="n">word_contexts_matrix</span><span class="o">.</span><span class="n">getrow</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()))</span> \
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">word_contexts_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> \
                                <span class="k">if</span> <span class="n">word_contexts_matrix</span><span class="o">.</span><span class="n">getrow</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">></span> <span class="mi">0</span>
                               <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [135]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bm25_vecs</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">bm25_vecs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [136]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bm25_vecs</span><span class="o">.</span><span class="n">prune</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [137]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bm25_vecs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[137]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(2427, 2441)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Paradigmatic-Similarity">Paradigmatic Similarity<a class="anchor-link" href="#Paradigmatic-Similarity">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below, we explore some preliminary Paradigmatic similarity measures using the above data.  By utilizing the BM25 precomputed matrix, we can calculate similarity scores for Word Documents.  We also plot the distribution of log base 10 similarity scores below.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-Word-Document-Similarity-Scores">Generate Word Document Similarity Scores<a class="anchor-link" href="#Generate-Word-Document-Similarity-Scores">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [138]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>

# Sim(d1,d2) = sum_over_i
word_sims = numpy.dot(numpy.dot(bm25_vecs, idf), bm25_vecs.transpose())
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 160 ms, sys: 4 ms, total: 164 ms
Wall time: 164 ms
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [139]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word_sims</span><span class="o">.</span><span class="n">prune</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [140]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word_sims</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[140]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(2427, 2427)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-Unique-Non-zero-entries">Get Unique Non-zero entries<a class="anchor-link" href="#Get-Unique-Non-zero-entries">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The similarity matrix is symmetric and contains two entries for each pair or word-documents.  Here we locate all non-zero similarity measures and remove duplicates.  The strict "less than" requirement also removes Word-Document self-similarity scores as well.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [141]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nz</span> <span class="o">=</span> <span class="n">word_sims</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [142]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">nz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[142]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>4404499</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [143]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">matches</span> <span class="o">=</span> <span class="n">nz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o"><</span> <span class="n">nz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [144]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nz</span> <span class="o">=</span> <span class="p">(</span><span class="n">nz</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">matches</span><span class="p">],</span> <span class="n">nz</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">matches</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [145]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">nz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[145]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>2201036</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [146]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dist</span> <span class="o">=</span> <span class="n">word_sims</span><span class="p">[</span><span class="n">nz</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [147]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dist</span><span class="p">)[</span><span class="mi">0</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [148]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dist</span><span class="p">),</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'purple'</span><span class="p">);</span>
<span class="n">g</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Log10 of Word Similarity Scores, BM25"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Log10 BM25 Similarity Score"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Count"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAgAAALBCAYAAADVrpNcAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAAPYQAAD2EBqD+naQAAIABJREFUeJzs3XlcVWXix/HvRWSRTa5b5vJyl51UDHGX5teiuaS5oKVW
Wrmb1piOUJmOlssvK5f86bjlTCOY61imYWrImFopgo2NS06JqMAFERCB+/ujF3e8cEW4YqB93q+X
r17d5zznec7h4er5nuc5x2A2m80CAAAAAAC/aw6V3QEAAAAAAFD5CAgAAAAAAAABAQAAAAAAICAA
AAAAAAAiIAAAAAAAACIgAAAAAAAAIiAAAAAAAAAiIAAAAAAAACIgAAAAAAAAIiAAgN+tzZs3y8fH
Rxs2bKjsrujMmTN6+umnb9ufL7/8UsOGDVObNm0UHBys/v3769NPP63w/ly+fFkvvPCCgoKC1KZN
G6WkpJTY5tChQ/Lx8dH06dNt7mPv3r3y8fHR888/b7M8ISFBPj4+GjduXIX2/Vb69+8vX1/fMm37
888/a+HCherbt69CQ0Pl7++v0NBQDR06VGvXrlV+fr5l219++aXU82CPDz/8UL6+vjp8+LDlMx8f
Hw0fPrzC2pDuTt9v5ccff9Tbb7+tXr16qX379goICFDHjh01cuRIbd68+a63X1V988038vHxsfrj
5+enzp07a9CgQVqxYoXy8vJuWWfr1q2l7r/oe6X42MnLy9OaNWvUs2dPBQYGqlOnTho2bJh27Nhh
tV3R96StP76+vvq///u/ijkRAFBFOFZ2BwAAlcdgMFR2F7R27Vr97//+r2rWrFlqf7Zu3arXX39d
3bt31wcffCBnZ2dt27ZNM2bMUFpamkaNGlVhfVq3bp3i4uI0btw4de3aVd7e3iW2CQkJkaenpw4c
OGBzH/v27ZMkHTlyRDk5OXJ1dS1RbjAY9Mgjj1RYv0tT1p/18ePHNWLECHl7e2vEiBHy9/dXtWrV
lJycrG3btmnu3LmKj4/X8uXLJUl169bVpk2bbJ4jew0ePFg9evRQ06ZNK2yfttjq+6lTp9SnTx/F
xsbqwQcfrJB29uzZo8mTJ6tp06YaMWKEWrRoIbPZrJ9//ll///vfNX36dJ04cUKRkZEV0t69qG/f
vpaL+MLCQqWmpmrHjh1atGiRDh8+bPNC3NnZWRs3blTfvn1t7vNf//qXTpw4IWdnZ6vPCwsLNXbs
WMXHx2vkyJHq2rWrrl69qlWrVunVV19VZmamhg4datneYDBo1qxZ8vPzK9HGAw88cCeHDQBVDgEB
APyOmc3mSm1/586deu+99/T666/L2dn5lndyb9y4oXnz5qlFixb68MMPVa1aNUlS+/btdeHCBX3w
wQd6+umnVbNmzQrp15UrV2QwGNS/f381aNDA5jbVqlVTly5dtHPnTiUkJCgwMNCqfP/+/Wrfvr2O
HDmi+Ph4hYeHW5UfOHBADg4O6t69e4X0uaK8//77ys3N1bp169SwYUPL523atFHPnj01YcIE7d27
13LM1atXl7+/f4X2oU6dOqpTp06F7tMWW32Pj4+v8OBs4cKFcnV11d/+9je5u7tbPm/Xrp169+6t
wYMH69NPP9VLL72kunXrVmjb94patWqV+Fl0795dqamp+vrrr/Xjjz+qZcuWVuVhYWHat2+fTp8+
rebNm5fYZ3R0tJo2bVpiBsLevXsVFxenF198Ua+88orl8w4dOig8PFwrVqywCggkqUmTJhU+zgGg
KmKJAQCgTI4cOaIXX3xRoaGhCggIULdu3TR9+nRduHDBaruCggK9//77Cg8PV1BQkHr27Km///3v
+uqrr0osIWjQoIFiYmI0ZMiQUtuOj49Xenq6+vTpYwkHivTv3195eXnas2dPhRyDj4+PtmzZIkl6
5JFH5OvrW+IYi4SHh8tsNltmCxT597//rQsXLmjAgAGqWbNmiXKTyaSEhAQFBQXJaDSWq39F7T71
1FP6+uuv9dhjj6lz586WsvPnz+vll19W27Zt1bZtWw0fPlwJCQm3PTdFkpOT5ezsfMu75++++66+
//57SyBia5r+66+/Lh8fH128eFEzZ85Ux44d1aZNGz377LM6e/asUlNTNXXqVIWGhio0NFQTJkxQ
Wlqapf4HH3wgHx8fqyUGthw9elRjxoyxnK/w8HBNmzZN//nPf6y2K+rPDz/8oCFDhig4OFg//vhj
ib4/++yzmjt3ruUc+/r6Kjo6Wj4+Plq/fn2J9gsLC9W5c2f94Q9/uO05NRqNVuFAEQcHB61evVrf
fvutVThQWFioNWvWqG/fvnrooYfUpUsXTZw4UadPn7aqbzKZNHv2bD3yyCMKCAhQSEiInn32WcXG
xlptV3RODx06pBdeeEFt2rSxGpdff/21nn/+ebVv315BQUF67LHH9N577yknJ8dqP//617/0yiuv
qHv37pap+S+++KKOHDlS6jmwV9Fd+5vHh/TrXf0uXbpYZhEUl5eXp+3bt+t//ud/SgShzZo107x5
8/TMM89Yfe7u7q4mTZooJSVFBQUFFXwkAHBvICAAANzW/v37NXLkSKWnp+uNN97QmjVrNHbsWH31
1VcaMmSI1T/e586dq6VLl6pt27ZasmSJJk2apOjoaK1atarEndng4GCbd/6KS0pKksFgUOvWrUuU
tW7dWmaz+bYXwWU9hk2bNqlbt26SpI8++kgxMTG3vKvbtWtXOTo6lggAipYPhIWFqX379iWWIcTF
xamwsNBqVkF5zrEk5eTk6J133tFrr72mpUuXSpKys7M1fPhwHT58WK+88oo++ugj9erVS9OmTVNq
amqp56eIj4+PcnNzNW3atBJtSpKrq6scHUufgGgwGGQwGPT666+rTp06Wrx4sSZOnKgjR47o1Vdf
1bhx4+Tr66slS5Zo8ODB2r17t+bPn1+ifmkSEhI0cuRIXbx4UXPmzNH69ev1wgsv6IsvvtDzzz+v
7OzsEvubPXu2evXqpfXr19ucGfL2229bZnQU/eyffPJJubu727wIPXjwoK5cuaJBgwaV2lcfHx/9
9NNPevfdd5WVlVWi3N3dvcTxRkVFacGCBXr88ce1evVqRUZG6vTp0xo6dKglAMnOzlZERIQ2b96s
Z555RqtXr9a8efPk6OiosWPHatu2bVbnQJLee+89BQUFae3atQoKCpIk/eMf/9Do0aN148YNzZ07
VytXrlTv3r21evVqjRo1ynKBnZaWpuHDh+vnn3/WzJkz9fHHHysqKkqZmZl67rnndPLkyVLPgz1O
nz6tatWqqUWLFiXK3NzcFB4erq1bt5aYJfD5558rMzNTffr0KVGvadOm6tu3b4lZKnl5efrpp59U
v379EkEkAPxesMQAAHBb77zzjlxdXfWXv/xFHh4ekn5dg+/t7a2JEydq7dq1euWVV5SVlaVPPvlE
LVu21IIFCyz1w8LC9Pjjj9vd/pUrVyT9Og25uKI78JcvX66QY/D397esSW/ZsmWp69A9PDzUrl07
HT58WGlpaZa+HDhwQC1atFC9evXUuXNn7d69W//+978tFzlFAcLNAUFZ+1fkp59+0gcffGB193r7
9u26ePGipk+frmeffVbSr8swmjRpohEjRpRp6vzUqVN14sQJ7dixQzt37lRwcLDatm2rhx56SCEh
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
CAAAAAAAgAgIAAAAAACACAgAAAAAAIAkx8ruAAAAAKqOwsJCpaen213f29tbDg7cgwKAexEBAQAA
ACzS09Ppy4soAAAgAElEQVQVtyJO7i7u5a6bmZMp/4H+MhqNdrVNuAAAlYuAAAAAAFbcXdzl5eZV
7nqZ2Zk6uvao6taqW+66WblZ6vRiJ9WqVavcdQEAFYOAAAAAABXGzcXNrnABAFD5mMMFAAAAAAAI
CAAAAAAAAAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEB
AAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEA
AAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAA
AAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAA
AAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAA
ABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAA
EAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQ
AQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAAJDk
WNkdAAAAAArNhUpLS7ujfXh7e8vBgftfAGAvAgIAAID7SGFhodLT0+2un5aWJnOhuQJ7VDZZOVk6
uvao6taqa1/93Cx1erGTatWqVcE9A4DfDwICAACA+0h6erriVsTJ3cXdrvrJ6cnydPJUTY+aFdyz
23NzcZOXm9dv3i4A4FcEBAAAAPcZdxd3uy+0M7Mzpd9+AgEAoApgkRYAAAAAACAgAAAAAAAABAQA
AAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAA
AAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAA
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
3UdAAAAAAAAACAgAAAAAAAABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQ
AQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABABAQAAAAAAEAEBAAAAAAAQAQEAAAAAABAB
AQAAAAAAkORY2R0AAAAA7lShuVBpaWl21/f29paDA/fOAPy+ERAAAADgnpeVk6Wja4+qbq265a+b
m6VOL3ZSrVq17kLPAODeQUAAAABQxRQWFio9PV2SlJ2drYyMDKWmpionJ+e2ddPS0mQuNN/tLlZJ
bi5u8nLzquxuAMA9i4AAAACgiklPT1fciji5u7gr70aeUlJSlFcvT07VnW5bNzk9WZ5OnqrpUfM3
6CkA4H5CQAAAAFAFubu4y8vNS3l5ecp2yZZXDS85Od0+IMjMzpR+nxMIAAB3iCexAAAAAAAAAgIA
AAAAAEBAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAA
AAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAA
AABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAA
AERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAA
REAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABE
QAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERA
AAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAA
AAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAA
AAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAA
AAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAAAABEQAAAAAAAAERAAAAAAAAAREAAAAAA
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
QAAAuIeUOyC4evWqPDw8NGnSJI0dO1Znzvx/e/ceplVZ74//PQjDwAzDSUUFBVMLFBBEEsO2iodK
22ZWim4zBRRLzdMuNcN06/aU2vaYUSrY1sw0FbW0FHfZbNsmpSJqJp5IRlTmGWAcZJCZ7x/+mJ8j
CMxweEBer+uaS1nP+qz1mcflMM973eu+X0pdXV0qKytTWVmZXr16rY0+AQAAgLWoVZMU3n777dl3
331TV1eXJOnQoUM+9alPZdiwYXnyySdzwAEHZOrUqWulUQAAAGDtWeWAYNq0aTn33HMzYsSINDY2
LvP65z73uey111457bTTMnPmzDXaJAAAALB2rXJA8POf/zx77LFHrrzyylRWVi7zemVlZS6//PIM
Hz48N9xwwxptEgAAAFi7VjkgeOqpp3LMMcesdL9x48blL3/5y2o1BQAAAKxbqxwQvP322+nbt+9K
99t6663z5ptvrlZTAAAAwLq1ygFBly5dUlNTs9L95syZk/Ly8tVqCgAAAFi3VjkgGDx4cO67776V
7vfLX/4yQ4YMWa2mAAAAgHVrlQOCI488Mj//+c/zi1/8YrmvNzY25uqrr84999yTo446ao01CAAA
AKx97Vd1xz322CPHHntszjvvvNx8883Zc88907t37zQ1NeXVV1/N1KlT88Ybb+TEE0/MiBEj1mbP
AAAAwBq2ygFBkpxyyikZOnRobrzxxtx6661paGhIknTq1CnDhw/PRRddJBwAAACADVCrAoIk2XPP
PbPnnntmyZIlKRQKKSkpSffu3dOu3So/rQAAAACsZ1odECy1ySabZNNNN12TvQAAAABF4rY/AAAA
ICAAAAAABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABABAQA
AABABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABA
BAQAAABABAQAAABABAQAAABAkvbFbgAAADZUjU2NqampWa1jdO/ePe3auW8HFJ+AAAAA2qhuYV2m
TZ6WzXtu3rb6d+sy8riR6dmz5xruDKD1BAQAALAaysvK07W8a7HbAFhtxjIBAAAAAgIAAABAQAAA
AADEHAQAwMdYY2NjCoVCm2pramrS1Ni0hjsCgPWXgAAA+NgqFAqpmliVirKKVtdWF6pTWVqZbl26
rYXOAGD9IyAAAD7WKsoq2jTD/Pz6+YkBBABsRMxBAAAAAAgIAAAAAAEBAAAAEAEBAAAAEAEBAAAA
EAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEB
AAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAA
EAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEBAAAAEAEB
AAAAEAEBAAAAEAEBAAAAkKR9sRsAAFiRxsbGFAqFNtXW1NSkqbFpDXcEAB9PAgIAYL1WKBRSNbEq
FWUVra6tLlSnsrQy3bp0WwudAcDHi4AAAFjvVZRVpGt511bXza+fnxhAAACrxBwEAAAAgIAAAAAA
EBAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAA
AAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAA
ERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAAERAAAAAASdoXuwEA4OOtsbExhUKh
zfU1NTVpamxagx3B+qOxqTE1NTWrvH99fX3mzZuXuXPnZuHChenevXvatXPPD1gzBAQAwFpVKBRS
NbEqFWUVbaqvLlSnsrQy3bp0W8OdQfHVLazLtMnTsnnPzVdp/4bFDZkzZ04aejWkYUlDRh43Mj17
9lzLXQIbCwEBALDWVZRVpGt51zbVzq+fnxhAwMdYeVn5Kv//0dDQkPqy+nTt3DULFy9cy50BGxvj
kQAAAAABAQAAACAgAAAAACIgAAAAACIgAAAAACIgAAAAACIgAAAAACIgAAAAACIgAAAAACIgAAAA
ACIgAAAAACIgAAAAACIgAAAAACIgAAAAACIgAAAAACIgAAAAACIgAAAAACIgAAAAAJK0L3YDAMD6
r7GxMYVCoU21NTU1aWpsWsMdAQBrmoAAAFipQqGQqolVqSiraHVtdaE6laWV6dal21roDABYUwQE
AMAqqSirSNfyrq2um18/PzGAAADWe+YgAAAAAAQEAAAAwAYSEPTv3z+DBw/Ozjvv3PzPCy64IEny
2GOP5Wtf+1qGDRuWf/3Xf829997bovbmm2/O5z//+ey66675t3/7t8yYMaP5tYaGhpxzzjnZc889
s1gfI6gAACAASURBVPvuu+fkk09ObW1t8+uzZ8/O+PHjs9tuu2XUqFG57LLL1s03DAAAAOvYBjEH
QUlJSR588MFsueWWLba/9dZb+da3vpVzzjknBx54YKZNm5ZvfvOb+cQnPpGddtopU6dOzbXXXpuf
/exn+dSnPpXJkydn/Pjxeeihh1JWVpYrrrgizz33XG6//fZ06tQp3//+93PWWWflxz/+cZLkxBNP
zKBBgzJ16tTMnTs3xx57bDbddNMcffTRRXgXAAAAYO3ZIEYQNDU1palp2dmN7r333my77bb58pe/
nNLS0uy+++4ZNWpUfvWrXyVJbr/99hxyyCEZNGhQSktLM27cuJSUlGTq1KlZsmRJ7rzzzpxwwgnp
1atXKisrc8opp+R//ud/8tZbb2X69Ol54YUX8p3vfCfl5eXZZpttcswxx+T2229f198+AAAArHUb
RECQJJdddln23nvvDB8+POecc07q6+szY8aM7LTTTi3223HHHTN9+vQkyTPPPJMdd9yx+bWSkpIM
GDAg06dPz2uvvZYFCxZkwIABza9/4hOfSFlZWWbMmJFnn302vXv3TkVFRYtjv/zyy6mvr1/L3y0A
AACsWxvEIwZDhgzJyJEjc8kll2TWrFk59dRTc95556W2tjZbbLFFi327du2aQqGQJKmtrU1lZeUy
r9fW1qa2tjYlJSXp2rXlck2VlZUpFArLre3W7f31mwuFQjp37rzK/S9atEioQJJk4cKFLf4Jrgk+
bH29Jurr69OwuCENDQ2trl28eHGWNC1pU+3q1herdk2ee2n9qh5nfel7XdYW89zruu8PXg8N7zWk
vr4+nTp1atO5+XhYX//eoHgWLVrU5toNIiC47bbbmv/9E5/4RE4//fR885vfzK677rrcRw9aY0X1
q3vspaqrq1NdXb1GjsXHwyuvvFLsFljPuCb4sPXtmpg3b17mzJmT+rLWB95v1r6Z9k3tU/JeSZvO
vTr1xapdG+eeO3fuWj/v6tZ/nN7vdVG7OvVz587NgncXpPQfpXnzzTfbdG4+Xta3vzfYMG0QAcGH
9e7dO0uWLEm7du1arDqQvD9qoGfPnkmSHj16NI8m+ODrn/zkJ9OjR480NTWltra2Reo6b9689OjR
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
F17IzTffnPLy8pSXl+eYY47JzTffLCCAtWR1RgAk748CKC9t250BEw0CAB9ldecvSMxhwPpPQLAC
zz77bHr37p2Kiv//TuSOO+6Yl19+OfX19encuXMRu4P11+oO83/29mfTpXOXNtUbBQAArA2rM39B
ksxfOD87fW2n9OjRo031wgXWBQHBCtTW1qaysrLFtm7d3v/QUSgUVhoQNDY2Jknq6urWToNsMObN
m5ckaWhoyIIFC/Laa6+ltLS0yF2tPQsWLMjzDzyfjqUdW11bqCukon1FGssa23TuTTpvkneb3k1h
SesDinc3eTebNG2yTmvfa3wvizstznsl7yXtss77Xt36YtUW89xru++l18S8xnlpv6R9q2qL2ffH
8dzrS98ruibW9HlXt/7j8H6vy9q21H/wevCeFaHv8k3a/DvKu4vezWO/eCyVXSpXvvOHLGpYlP6f
758uXZa9gbKx/H65rnXtuuHOU7H08+fSz6OtUdLU1GRA7Uf4yU9+kt///ve54447mre99tpr+dzn
PpeHHnoovXv3XmH93Llz88orr6zlLgEAAKClfv36tXrVDSMIVqBHjx6pra1tsa22tjYlJSWrNDSo
a9eu6devXzp27Gg4EAAAAGtdY2NjFi1a1KZREAKCFRg4cGCqq6tTW1vb/GjB008/ne222y6dOnVa
aX379u2tkwoAAMA69cF59FrDbe0VGDBgQAYNGpTLL788dXV1mTlzZiZNmpQjjjii2K0BAADAGmUO
gpWYM2dOJkyYkMcffzwVFRU5/PDDc8IJJxS7LQAAAFijBAQAAACARwwAAAAAAQEAAAAQAQEAAAAQ
AQEAAAAQAQEAAAAQAQEAAAAQAcFaN3v27AwePDg777xz89fgwYPTv3//VFdXF7s9iuhXv/pV9tln
nwwZMiSjR4/Oc889V+yWKKJRo0Zl4MCBzT8jdt5553zrW98qdlusByZPnpz+/ftn9uzZxW6FInr9
9ddzwgknZLfddsuIESNy3HHH5ZVXXil2WxRRbW1tzjjjjOyxxx4ZMWJETjrppLzxxhvFbosimz59
evbff/+MHj262K1QJLNnz8748eOz2267ZdSoUbnssstaVS8gWMu22mqrPP3003nqqaeavy688MIM
GTIkW265ZbHbo0j+53/+J1dffXWuvPLK/PnPf87ee++dH//4x8VuiyKbNGlSnnrqqeafGdddd12x
W6LI3nzzzdx0000pKSkpdisU2QknnJDNN988f/jDHzJ16tRUVFTk1FNPLXZbFNGZZ56Zmpqa3H//
/fnd736XxYsX53vf+16x26KI7r333nz7299Ov379it0KRXTiiSdmiy22yNSpUzNp0qT8/ve/z6RJ
k1a5XkCwjtXV1eWHP/xhvv/97xe7FYroxhtvzJgxYzJw4MCUlZVl/Pjxueqqq4rdFkXW1NRU7BZY
z/znf/5nDj/88GK3QZEtXrw4X//613PaaaelrKwsnTt3zhe/+MW8+OKLxW6NItpyyy1zxhlnpGvX
rqmsrMzo0aMzbdq0YrdFETU0NOT222/P4MGDi90KRTJ9+vS88MIL+c53vpPy8vJss802OeaYY3L7
7bev8jEEBOvYjTfemF122SUDBw4sdisUSWNjY5588sm0a9cuX/nKVzJ8+PCMHTs2s2bNKnZrFNnk
yZOz3377ZZdddsm3v/3t1NTUFLsliugPf/hDXnjhhYwZM0Z4tJHr0KFDvvKVr6RLly5Jkurq6tx6
66054IADitwZxfSDH/wg22+/ffOfZ8+enc0226yIHVFsX/nKV1wDG7lnn302vXv3TkVFRfO2HXfc
MS+//HLq6+tX6RgCgnXonXfeyS233JLjjz++2K1QRDU1NWloaMg999yTH/3oR3nooYfSsWPHnHzy
ycVujSLaaaedMnjw4EyZMiW//e1vM2/ePNfERmzRokW54IILcs4556RDhw7Fbof1yKBBgzJq1Kh0
7tw55513XrHbYT3xz3/+M1dddZW5a2AjV1tbm8rKyhbbunXrliQpFAqrdIz2a7yrjdCUKVPy3e9+
t8Uzok1NTSkpKclFF12Ugw8+OEly991355Of/GQ+9alPFatV1pEVXRNLnxk98sgjs8022yRJvvOd
7+QLX/hCXn311fTt27coPbN2reznxNVXX928vVOnTjnnnHNy4IEHZtasWdl6662L0TJr0cquh5df
fjmDBw/O7rvvXsQuWZdW9XeJ6dOnZ86cObnkkksyZsyY3HrrrcVqmbVsVa+JmTNnZty4cTnkkENy
yCGHFKtd1oFVvSbYuK3uqEMBwRpw0EEH5aCDDlrpfg888ED22WefddARxbaia6KxsTFXXnll81DR
JOndu3eS5K233hIQfEyt6s+Jpfr06ZPk/UnqBAQfPyu6Hl566aVceumlueeee9ZxVxRTa35G9OrV
K2eddVY++9nPZsaMGdlpp53WcncUw6pcE08//XSOO+64jB07Nscee+w66oxiae3vEmx8evTokdra
2hbbamtrU1JSkh49eqzSMTxisI7U1tZm2rRpGTlyZLFbocjatWuXfv36tVjW8J///GdKSkqagwI2
LrNnz865556bxYsXN2978cUXU1JSIhzYCP3mN79JXV1dDjrooIwYMSIjRoxIknz5y1/ODTfcUOTu
KIaXX345e+21V+bNm9e8bekdxPbt3evZWL3yyisZP358zjzzTOEAkCQZOHBgqqurW4QETz/9dLbb
brt06tRplY4hIFhHnn/++TQ1NTXfFWTjNnr06Nxyyy155plnUldXlx/96EcZMWKEpS83Uj179szU
qVNzySWXZOHChZkzZ04uvvjijBo1Kptvvnmx22MdO+aYY/L73/8+d999d+65557mkQQ//elPrWu9
kerbt2+6dOmSCy64IAsWLEhdXV0uv/zy9O3bN9ttt12x26NI/uM//iOHHnqoYeUsw8S2G68BAwZk
0KBBufzyy1NXV5eZM2dm0qRJOeKII1b5GCVNrqB14v7778+ECRPy17/+tditsJ645pprctttt+Wd
d97JZz7zmZx//vmrPPSHj59//OMfufjii/P000+npKQk++23X84666wWs9Cy8RowYEAefvjhbLXV
VsVuhSKprq7O+eefn8ceeywdO3bMzjvvnDPPPDPbbrttsVujCN54443svffezZOYlpSUND+LfsMN
N2TXXXctcocUw+c///lUV1dnyZIlaWxsTPv27VNSUpIHHnjATaiNyJw5czJhwoQ8/vjjqaioyOGH
H54TTjhhlesFBAAAAIBHDAAAAAABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABABAQAAABAB
AQAAABABAQAAABABAQAbmTPPPDN77LHHOj/vpEmTMnDgwJx++unLff2JJ57IkUcemSFDhmT48OE5
9dRT8+abb67wmNdcc0369++fAQMGNP9z9913z9e//vU8+OCDLfa966670r9//+y3334r7LF///45
6qijWmx/6KGHcthhh2XYsGH57Gc/m1NPPTWzZs36yD6Wfg0YMCAzZsxY4fdQXV2dCy+8MJ///Ocz
dOjQDB48OF/4whdy2WWXZdGiRc37nXXWWWvkv1v//v1zxRVXJEkef/zx9O/fP3/6059W+7jXXHNN
BgwYkIaGhtU+1ofdf//9Ofroo7PHHntk4MCBGTFiRMaOHZu//OUva/xcAGzcBAQAbFRKSkrW6fnm
zZuX448/PjfddFM6deq03H1efvnljBs3Lttss03uvvvuTJw4MbNnz864ceOyZMmSFR6/pKQkjzzy
SKqqqvLoo4/mxhtvTO/evXPyySfn4YcfXmb/uXPn5vHHH1/use6555507ty5xbYHH3wwJ554Ynbb
bbf8+te/zn/913/lxRdfzLhx41p8gN9yyy1TVVXV4utPf/pTBgwY8JG9FwqFfPWrX82TTz6ZCRMm
5IEHHshdd92Vf/u3f8stt9ySU089tXnfs88+O/fee+8K34tVUVVVlW9+85vNf15T18PYsWPzpz/9
KaWlpUmS//u//8uoUaNW+7jXXXddvvvd72b33XfP5MmT89BDD+Wqq65KU1NTxo4dm6eeemq1zwEA
SwkIAGAtuu+++/Luu+/mrrvuSpcuXZa7z8SJE9OjR49ccMEF6devX4YOHZqLL744L7zwwjIjAZan
R48e6dmzZzbddNMMGDAgF154YTp16pSpU6cus+/SD/of9ve//z3PP/98hg8f3mL7DTfckBEjRuS0
005L3759M2zYsJx11ll59dVXU1VV1bxfu3btmvv44Fe7dh/9q8Zvf/vb1NTU5IorrsjIkSPTq1ev
bLfddjnyyCNz1llnZd68eSkUCkmSioqKdO/efaXvxcr07NmzRVDT1NS02sdMkk6dOqVnz57Nf/7r
X/+6RsKHW265Jf/6r/+a8ePHZ7vttssWW2yRT3/607n++uuz44475m9/+9tqnwMAlhIQAMByPPLI
IznssMOy8847Z+jQoTniiCPyv//7vy32mTZtWg455JAMHjw4+++/f+66666cc845Le4c77XXXrnp
ppvSo0ePjzxXVVVV9thjjxYfprfddtv06dMnf/zjH9v8PXTt2rXFn0tKSrLPPvvkwQcfTH19fYvX
7r777uy8887L9HnTTTflyiuvbLGtV69eSbLMMVpr6XD8D45EWOrQQw/NLbfc0hwKfPjRkFGjRuX8
88/Pz372s/zLv/xLhgwZkuOPPz4LFizIzTffnFGjRmXYsGE54YQTUldX11z3wUcMlmfKlCnN/013
3XXXHHHEES2G8r/++uvp379/fvWrX2X06NEZPHhw6urqcvXVV6d///5paGjIWWedlSuvvDKvv/56
BgwYkPPPPz+DBw/ONddcs8z5xo4dm8MOO+wj+3n33XeX+/6Ulpbmtttuy9FHH928ra6uLueee272
2GOPDB06NKNHj17mmv31r3+dgw46qPn7Gzt2bIvHQJY+ivLHP/4x++67b772ta81v3bPPffk0EMP
zbBhw7LbbrvltNNOy5w5cz6ydwA2PAICAPiQ//3f/823vvWtDBgwIHfeeWduv/329OrVK8cdd1ye
e+65JO8Pjx8/fnxKS0vzi1/8Ipdffnl++ctf5s9//nOLO8e9e/de4Z3k+vr6vPnmm9l6662Xea1v
37556aWXWtX7/Pnzc+mll6Z9+/Y59NBDl3n9c5/7XN5777385je/ad62ZMmS3HvvvfniF7+4zP7l
5eXLBA0PP/xwNtlkkwwePLhVvX3YyJEj065duxx99NG59dZbV/hhc3nv4aOPPpo33ngjN998cy65
5JL84Q9/yPjx4/Pcc8/lhhtuyMUXX5ypU6dm8uTJq9TPE088kTPOOCN77713Hnjggdxxxx3p169f
xo8fn7feeqvFvjfddFMOPfTQ/O53v0t5eXlKSkqaezz77LOzzz77ND928e///u/Zf//9c88997Q4
RqFQyP/93/+1+BD+Yf/yL/+S3/72tzn99NPzxBNPZPHixR+578knn5zHHnssV1xxRaZMmZKBAwdm
/Pjxef7555Mkd9xxR773ve819zJ58uS89957Oeqoo5Z57ydOnJiLLroo119/fZL3w4Ezzjgju+yy
S+66665cd911eemllzJmzJi89957q/T+ArD+ExAAwIfccMMN2X777XPuuedm++23zw477JBLL700
5eXlufXWW5Mkv//97/POO+/kP//zP7PTTjtl0KBBue666/LGG2+06lxL726Xl5cv81p5eXkWLFiw
wvqmpqaMGDEiQ4cOzdChQ/PpT386U6ZMySWXXJJ+/fots3+XLl2y11575c4772ze9sc//jG1tbU5
4IADVtrv9OnTc8011+SrX/1qttlmm+bt7777bs4///x84QtfyIgRI/L1r3/9I+c6WGqHHXbIlVde
mXbt2uX888/Pnnvumf322y8/+MEPVlqbJO+9917OPvvs9OvXL5/73Oey/fbb5x//+EfOPffcbLvt
ttlvv/2y/fbbN4c6KzNw4MDcd999+da3vpWtttoq/fr1y9ixY1NfX5+//vWvLfb95Cc/mUMOOSRb
bLHFMuFFRUVFOnbs2PzYRadOnTJ69Oj885//bPF9PfDAAyktLV3h+37++efngAMOyG9/+9scTK2h
TwAACk5JREFUeeSRGT58eI455phMmjQp8+bNa95vxowZqaqqyhlnnJFPf/rT2XrrrfO9730vBx54
YF5//fUkyc9+9rPstddeOfHEE7Pttttmp512yhVXXNH8CMwHHXDAARk+fHjzYxM/+clP8ulPfzpn
nnlmttlmmwwbNiwXX3xxZs6cuUqPwQCwYRAQAMCHPPPMM9lll11abOvQoUMGDhzYPBx71qxZKSsr
y3bbbde8T48ePbLzzjuv015LSkpyxx13ZMqUKZkyZUruvPPOHH/88TnjjDPyox/9aLk1X/rSl/Lk
k0/mlVdeSfL+4wW77777Ch+DSJK//OUvGTNmTHbdddd8//vfb97euXPnlJWVZZtttslVV12Vq6++
OuXl5Tn66KPzxBNPrPCY++67b6ZOnZobb7wxxx13XDbddNPceeedOeqooz5yxYelPvWpT7X4cN6t
W7f069cvHTt2bLFtZSHLUmVlZfnrX/+aI488MiNHjszQoUPz1a9+NSUlJamtrW2x70477bRKx1xq
1113zfbbb9/ig/hvfvObHHDAActMDPlBFRUVueKKKzJ16tScd9552WefffLiiy/m4osvzv777988
SeHTTz+dkpKSFqM62rVrl4svvjj77LNP6urq8sorryxzXffs2TNbb711nn322eZtJSUlGThwYPOf
6+rq8tJLL2XkyJEtavv375+uXbuudKUKADYcAgIA+JC6urrlTihYUVGRd955J0lSW1u73A92rZ1I
b+l5Pvic/Af7+PDw/uXp06dPtt5662y99dbZaaedctRRR+W73/1uJk6cmJkzZy6z/5577pnKysr8
+te/zvz58/PII4/koIMOWuE5HnzwwYwbNy6f+cxn8pOf/CQdOnRofm3MmDF5+OGH841vfCM77LBD
hg8fnmuuuSZbbbXVcp+7/7BNNtkku+++e0477bT84he/yCOPPJL9998/v/nNb5a7EsNSy3v/l7dS
xKpORDhp0qRMmDAhO+64Y66//vpMmTIlEydOXG59ZWXlKh3zgw477LA88MADqa+vz5w5czJt2rTl
PgayPFtssUUOO+ywXH755Xn00Udz1VVXZcmSJTn33HOTpDkEWd5IlCTN1+3KruulPrjf0teuvfba
5pEqS78WLFiwzOMXAGy42he7AQBY33Tp0mW5d53r6uqaPxiWlpZm4cKFy+zz4TvNK9OpU6dsueWW
ee2115Z57ZVXXsnuu+/equMtNWjQoDQ1NeUf//hHi1EOyfujIT7/+c/n/vvvT58+fbLJJptk3333
/chjPfLIIznttNNyxBFH5Oyzz16l87dv3z7bb799Xn311Y/cp6mpKe+8804qKipabN9ss81y4YUX
5ne/+13+/ve/Z5999lmlc66uKVOmZMiQIZkwYULztrfffnuNHf9LX/pSLr/88jz88MMpFArZbrvt
VjqPw4IFC5b7oX7//ffPtGnTcssttyRJ8+iP+fPnLzckWfoeL++6XrBgQfr06fORPSw9/9FHH73c
+RJWNAICgA2LEQQA8CE777zzMs+cL1q0KM8880zzB7q+fftm4cKFLe7Qz5kzJ08++WSrz7fnnnvm
0UcfzZIlS5q3Pfvss5k9e3aLFRFaY+bMmSkpKWleceDDDjrooLz++uvNM/4v70Pl0uOcdtppOfLI
Iz8yHLj00ktz2223tdi2ePHiPP/889l2220/sseDDz443/zmN5f72qxZs5K8f+d8XVm8ePEyj1nc
ddddKSkpadNyiB+u6dKlSw444IDcd999ue+++1Y4OWHy/jwXw4cPz5///Oflvj5r1qxsttlmSd6f
E6GpqWmZuRuOP/743HLLLSkvL8/222+/zCMfb775Zv75z3+uMKjo3Llzdthhh7z88svNI1WWfi1a
tGilj6YAsOEQEACw0Wlqasrbb7+9zNfSu6vjxo3LSy+9lHPPPTcvvfRSnnvuuZx66qlpaGjIkUce
meT9Z+fbt2+fCy64IM8//3ymT5+e008/fZnVCObNm5e33347b731VhobG7No0aLm8y1dvm7cuHF5
5513cvbZZ+eVV17J008/ne9973sZMmTIKt09/+D3MGvWrNx///258MILs/fee2fo0KHLrRk2bFj6
9OmTmTNnrvDxggsvvDCbbbZZxowZs8z7tfSxiKamplx44YW55ZZb8tprr2XGjBk5/fTT8/bbb2fs
2LEfeeyTTjopf/vb33L88cenqqoqs2bNyssvv5x77rknJ510UrbffvtVmjhxTRk6dGj+/Oc/57HH
Hsurr76ayy67LMn7j0A89dRTKRQKq3ysysrKvP3223niiSeaw47k/ccMqqqq8ve//z1f+tKXVniM
vfbaK0OHDs3JJ5+cyZMn5/nnn091dXWefPLJnHPOOXnkkUdy0kknJUkGDx6c3XbbLT/84Q/z+OOP
Z9asWbnkkktSVVWVYcOGJUmOPfbYPProo7n22mvz6quv5sknn8zJJ5+c7t2755BDDllhL8cff3we
fvjhXHPNNZk5c2ZmzpyZSy65JF/+8pdXeRJIANZ/HjEAYKNTU1OTz372s8ts32effXLNNddk+PDh
ue6663LttdfmkEMOSbt27TJkyJDcfPPNzXfEt9pqq1x11VX54Q9/mEMPPTR9+/bNySefnHvvvTf/
+Mc/mo954okntrhrO2fOnObn6i+66KIcfPDB6dOnTyZPnpyLL744Bx98cDp27JhRo0blzDPPXKXv
54MhQllZWfr06ZNvfOMb+cY3vrHCuoMOOii33XZb9thjj4/cp6qqKiUlJdlrr72Wee3ggw/ORRdd
lO9+97vZbLPNctttt+Wyyy5Lu3btMmjQoNx0003NH06XZ999981///d/5+c//3nOOeeczJ07NyUl
JenTp08OPPDAjBs3LmVlZc37f3BCwo9aOnJ52z9c91HHOeWUU/L222/npJNOSseOHXPQQQflBz/4
QTp16pTbbrstJSUlOeGEE1bp3KNHj05VVVWOOeaYHHHEETnrrLOSvP9BvlevXtlll11WOr9Ehw4d
MmnSpPz85z/PlClTcv3112fBggXp2rVrBg0alBtuuCGf+cxnmve/9tprc+mll+bUU09NfX19PvnJ
T2bixInp379/kvcfcWhqasqNN96Yn/zkJykrK8tuu+2Wiy66KN26dVthLwceeGDatWuXn/70p5k4
cWI22WSTDBo0KDfeeGN23HHHFdYCsOEoaWrLmDkAIPPmzUtZWVmLWfMPPvjgbLHFFs3rx8MHPfPM
Mzn00ENzxx13+GANwHrHCAIAaIN58+Zl1KhR2XXXXXPqqaemU6dOmTJlSv7+97/n29/+drHbYz1T
KBTy4osv5uyzz84Xv/hF4QAA6yUjCACgjaZPn57/+q//yjPPPJP33nsvffv2zZgxY/LFL36x2K2x
nhkzZkymT5+efffdNxMmTDDzPwDrJQEBAAAAYBUDAAAAQEAAAAAAREAAAAAAREAAAAAAREAAAAAA
REAAAAAAREAAAAAAREAAAAAAJPl/eVXyx8tzRDYAAAAASUVORK5CYII=
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [149]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">([</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">50</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">95</span><span class="p">,</span> <span class="mf">0.995</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[149]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>count    2.201036e+06
mean     2.768429e-03
std      4.462091e-03
min      7.221888e-07
25%      4.303217e-04
50%      1.494851e-03
75%      3.309476e-03
90%      6.512896e-03
95%      9.765315e-03
99.5%    2.674414e-02
max      4.357798e-01
dtype: float64</pre>
</div>
</div>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  

</article>
        </div><!-- /content -->

    </div><!--/.container /#main-container -->

    <footer id="site-footer">
 
      <address id="site-colophon">
        <p class="text-center text-muted">
        Site built using <a href="http://getpelican.com/" target="_blank">Pelican</a>
        &nbsp;&bull;&nbsp; Theme based on
        <a href="http://www.voidynullness.net/page/voidy-bootstrap-pelican-theme/"
           target="_blank">VoidyBootstrap</a> by 
        <a href="http://www.robertiwancz.com/"
           target="_blank">RKI</a>  
        </p>
      </address><!-- /colophon  -->
    </footer>


    <!-- javascript -->
   
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>


  </body>
</html>