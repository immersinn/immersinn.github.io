<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="TRII" />
    <meta name="generator" content="Pelican (VoidyBootstrap theme)" />

    <title>Frequent Pattern Mining - Apriori Pt. 01 - immersinn-ds</title>

   
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />  



    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="./favicon.ico" />
        <link href="http://immersinn.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="immersinn-ds Atom Feed" />
  </head>

  <body>
   
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
	   <div class="navbar-header">
		<button type="button" class="navbar-toggle" 
				data-toggle="collapse" data-target="#main-navbar-collapse">
		  <span class="sr-only">Toggle navigation</span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="./" rel="home">
          <i class="fa fa-home fa-fw fa-lg"> </i> </a>
       </div>

      <div class="collapse navbar-collapse" id="main-navbar-collapse">
        <ul class="nav navbar-nav">
            <li class="divider"></li>
            <li class="">
              <a href="./archives.html">Archives</a>
            </li>
          <li class="divider"></li>
            <li><a href="http://immersinn.github.io/feeds/all.atom.xml" 
                   type="application/atom+xml" rel="alternate">
                <i class="fa fa-rss fa-fw fa-lg"></i> </a></li>
        </ul> <!-- /nav -->
      </div> <!-- /navbar-collapse -->
	  </div> <!-- /container -->
    </nav> <!-- /navbar -->

	<div class="jumbotron" id="overview">
	  <div class="container">
		<h1><a href="./">immersinn-ds</a></h1>
	  </div>
	</div>

    <div class="container" id="main-container">
        <div class="" id="content">
<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
<abbr class="article-header-date">
  Fri 21 October 2016
</abbr> <h1>
  <a href="./fpm-apriori-p01.html" rel="bookmark"
     title="Permalink to Frequent Pattern Mining - Apriori Pt. 01">
    Frequent Pattern Mining - Apriori Pt. 01
  </a>
</h1><div class="article-header-info">
  <p>
      Posted by <a href="./author/trii.html">TRII</a>
    in 
    <a href="./category/frequent-pattern-mining-course.html">
      frequent-pattern-mining-course</a>
    &nbsp;&nbsp;
  </p>
</div> <!-- /.article-header-info -->  </header>
  <div class="content-body" itemprop="text articleBody">
	<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
@-moz-document url-prefix() {
  div.inner_cell {
    overflow-x: hidden;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction-/-Overview">Introduction / Overview<a class="anchor-link" href="#Introduction-/-Overview">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Continuing with the <a href="https://immersinn.github.io/simp-vsm-inst.html">Coursera Courses Theme</a>, this post will kick off a series of posts related to the <a href="https://www.coursera.org/learn/data-patterns/home/welcome">Pattern Discovery in Data Mining Course</a>.  As one might expect, the course covers introductory topics related to finding interesting pattern in data.  "Pattern" is a fairly loaded term, so for now we'll leave the definition and exploration of the general field to the course and other resources.</p>
<p>For the first article in the series, we look into the <a href="https://en.wikipedia.org/wiki/Apriori_algorithm">Apriori Principle (Algorithm)</a> and how it can be used to find frequent patterns in a dataset.  The bare-bones explanation of Apriori is that large frequent patterns cannot have subsets that are not frequent in the dataset.  This principle really is as intuitive as it seems!  Why, then, is it useful?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">nltk</span> <span class="k">import</span> <span class="n">FreqDist</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">"whitegrid"</span><span class="p">,</span> <span class="n">color_codes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">8675309</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="General-Problem-Overview">General Problem Overview<a class="anchor-link" href="#General-Problem-Overview">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, what is a pattern in the sense we are using?  Many types of patterns manifest themselves, and the general practice of finding them is referred to as <a href="https://en.wikipedia.org/wiki/Pattern_recognition">Pattern Recognition</a>.  Our particular use case revolves around co-occurring items in itemsets, or <a href="https://en.wikipedia.org/wiki/Association_rule_learning">Association Rule Learning</a>.</p>
<p>The typical example is to imagine a shopper buying a set of items at a grocery store.  In this case, things like milk, cheese, bread, eggs, and peanut butter are all items.  For a particular transaction -- that is, a particular shopping visit -- an individual purchases some subset of the items available in a grocery store.  If we were to take all transactions that occurred in a week or month or year, we could count up how many transactions contained each grocery store item.  This count or frequency would give us the <a href="https://en.wikipedia.org/wiki/Association_rule_learning#Support">support</a> of each item (the support can refer to both the raw count of occurrences and the fraction of transactions containing an item).</p>
<p>While determining the most frequent items may be of interest, we would also likely be interested in which items were often purchased together.  In other words, which itemsets are frequent in the dataset?  However, given all of the items in a grocery store, there are a humongous number of possible item combinations that could occur in any given transaction.  How do we efficiently sort through all of these patterns and count only the ones we are interested in?</p>
<p>This is where the Apriori Principle comes in.  Starting with itemsets containing only a single item, we determine the items' respective supports.  If the support for an item meets the given threshold, then the item is deemed a Frequent-1 itemset.  For instance, if we say that all items occurring in more than 100 total transactions are frequent, and milk occurs in 2200 transactions, but sardines only shows up in 30 transactions, then we say that "milk" is a frequent itemset, but "sardines" is not.</p>
<p>Once we have the Frequent-1 itemsets, we can intelligently construct the potential Frequent-2 candidates using Apriori.  Since we know that no Frequent-2 itemset can contain an itemset that is not a Frequent-1 itemset, the only possible candidates for Frequent-2 itemsets are the pairwise combinations of all Frequent-1 itemsets.  We can therefore avoid counting the supports for a large number of patterns that cannot be frequent in the dataset!  We can continue this process for finding Frequent-3 itemsets and beyond.</p>
<p>In practice, while Apriori does allow us to prune a significant number of options, for any moderately sized dataset, a large number of potential candidates still exists.  While methods exist for making the process a bit more efficient, for now we look to Parallel Processing to speed up the support counting.</p>
<p>Additionally, while many variations exist with regard to applying Apriori and pattern finding in general, we only look at using the basic principle and a straight-forward implementation of the process.  Later posts will examine various other avenues for finding frequent patterns and actually doing things with those patterns.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Overview">Data Overview<a class="anchor-link" href="#Data-Overview">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the core set of the Pattern Discovery articles, we will utilize the <a href="https://www.kaggle.com/c/talkingdata-mobile-user-demographics">Talking Data</a> dataset from a past Kaggle competition.  The goal of the competition was to use the collection of installed and active applications on an individual's smart phone in order to determine the user's demographics (Male v. Female and age group).</p>
<p>The dataset contains a large number of readings from users' phones.  Each reading specifies the set of installed and active applications on the user's phone.  Location data exists as well, but we are not currently interested in that data.  From the full set of readings, we can determine the set of installed an active applications for each user in the dataset.</p>
<p>Readings are timestamped, and several readings exist for each user in the dataset.  This provides us with each user's application history over time.  While later articles will hopefully focus on this aspect of the data, for now we simply collect all readings for a user in order to define each user's transaction.</p>
<p>Specifically, we only look at those applications flagged as "active" for a particular user for at least one reading associated with that user.  This reduces the dataset quite a bit, while also ensuring that the patterns found are "interesting" in the sense that they provide pertinent information about application use and not just application presence.  The set of applications that are "active" for at least one reading associated with a user are that user's transaction.  We will mine patterns from the set of user transactions in the dataset.</p>
<p>Much of the preprocessing on the original Talking Data dataset was performed previously in <a href="http://immersinn.blogspot.com/2016/07/talkingdata-mobile-user-demo-kaggle.html">an older post</a> (which apparently is no longer hosted by Google; need to fix that), so that will not be covered here.  We do cover transitioning the output of that post to a transaction table, though.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Goals-for-Current-Dataset">Goals for Current Dataset<a class="anchor-link" href="#Goals-for-Current-Dataset">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To summarize, the goal of this post is to generate all of the pieces required for extracting frequent patterns across user transactions generated from the Talking Data dataset.</p>
<p>Constructing the Transaction DataFrame from the Talking Data dataset involves merging all rows in the dataset corresponding to a single User / Device ID that consists of (AppID, is_installed, is_active, DeviceID) tuples.  Application IDs in the resulting transaction dataset correspond to the union of installed Applications across all sample points in the data for the specified User.</p>
<p>For the current iteration of the Frequent Pattern Mining Problem, we treat each of these Application ID sets as a Transaction in our dataset, with one Transaction per User.  The goal is to mine all frequent patterns across this set of transactions.  This involves utilizing the Apriori Algorithm in a very straight-forward manner.</p>
<p>This post develops the tools required to accomplish the goal.  The next post will carry out the full implementation of the method on the dataset and review the findings.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Load-&amp;-Preprocess-Data">Load & Preprocess Data<a class="anchor-link" href="#Load-&amp;-Preprocess-Data">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we load the existing dataset from previous work and further process it into the form desired for pattern mining.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="s2">"../../../Analytics/Kaggle/TalkingData Moble User Demographics/"</span>
<span class="n">user_apps_data_file</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="s2">"data/proc/user_apps_train_df.pkl"</span>
<span class="n">user_info_file</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="s2">"data/gender_age_train.csv"</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_info</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">user_info_file</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">user_apps_data_file</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">user_apps</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_info</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>device_id</th>
<th>gender</th>
<th>age</th>
<th>group</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>-8076087639492063270</td>
<td>M</td>
<td>35</td>
<td>M32-38</td>
</tr>
<tr>
<th>1</th>
<td>-2897161552818060146</td>
<td>M</td>
<td>35</td>
<td>M32-38</td>
</tr>
<tr>
<th>2</th>
<td>-8260683887967679142</td>
<td>M</td>
<td>35</td>
<td>M32-38</td>
</tr>
<tr>
<th>3</th>
<td>-4938849341048082022</td>
<td>M</td>
<td>30</td>
<td>M29-31</td>
</tr>
<tr>
<th>4</th>
<td>245133531816851882</td>
<td>M</td>
<td>30</td>
<td>M29-31</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_apps</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[9]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>app_id</th>
<th>is_installed</th>
<th>is_active</th>
<th>device_id</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-9215638741604613652</td>
</tr>
<tr>
<th>1</th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-9212424538588397592</td>
</tr>
<tr>
<th>2</th>
<td>4.460015e+18</td>
<td>1.0</td>
<td>0.0</td>
<td>-9212424538588397592</td>
</tr>
<tr>
<th>3</th>
<td>8.693964e+18</td>
<td>1.0</td>
<td>1.0</td>
<td>-9212424538588397592</td>
</tr>
<tr>
<th>4</th>
<td>-1.254571e+18</td>
<td>1.0</td>
<td>1.0</td>
<td>-9212424538588397592</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_apps</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[10]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(1171795, 4)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Restrict-Data">Restrict Data<a class="anchor-link" href="#Restrict-Data">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Clean-up-Empty-Rows,-Remove-Rows-that-are-not-&quot;active&quot;">Clean up Empty Rows, Remove Rows that are not "active"<a class="anchor-link" href="#Clean-up-Empty-Rows,-Remove-Rows-that-are-not-&quot;active&quot;">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For a previous iteration, a "dummy row" were introduced for each User to ensure that every User occurring in the original dataset had an entry in the User-Application dataset, regardless of whether the User was ever recorded as having an application installed or active.  Here we remove those rows as they will not contribute to the transaction dataset.</p>
<p>Additionally, the dataset is restricted to only those rows for which the corresponding application is recorded as "active".  We have decided to define patterns of interest in the dataset as patterns corresponding to Active applications, not Installed applications.  Restricting the problem in this manner has the added benefit of reducing the number of rows in the dataset, and thus reducing the overall transaction dataset.  This dataset reduction will have an impact on the overall computation time.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Remove all NaN rows (added to force a user to exist in the data)</span>
<span class="n">user_apps</span> <span class="o">=</span> <span class="n">user_apps</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Keep only rows pertaining to "active" apps (example of "Constraint Based Pattern Mining" --> Data Constraints)</span>
<span class="n">user_apps</span> <span class="o">=</span> <span class="n">user_apps</span><span class="p">[</span><span class="n">user_apps</span><span class="o">.</span><span class="n">is_active</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_apps</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[12]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(349505, 4)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Number of unique users</span>
<span class="nb">len</span><span class="p">(</span><span class="n">user_apps</span><span class="o">.</span><span class="n">device_id</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[13]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>23247</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Remove-all-rows-corresponding-to-items-that-are-active-less-than-the-min_sup-value">Remove all rows corresponding to items that are active less than the <em>min_sup</em> value<a class="anchor-link" href="#Remove-all-rows-corresponding-to-items-that-are-active-less-than-the-min_sup-value">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this step, we perform a sort of pre-Apriori Apriori method. Instead of building a transaction for each User that contains all installed Applications in the dataset corresponding to that User, we preemptively remove Applications that are not frequent in the dataset and do not include them in User applications.</p>
<p>In doing this, we reduce the size of many User transaction sets. Reducing transaction sizes means that the time spent looking for itemsets within transactions is also reduced. This reduction is achieved in every iteration over the dataset. Removing non-frequent-1 itemsets, then, has a compound reduction effect.</p>
<p>If complete transaction sets were desired at the end of the process in order to conduct more complex analyses, the removed itemsets (Applications in this case) could be re-added to the appropriate Users' transactions after frequent pattern mining was complete.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">min_sup</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Usage count per app</span>
<span class="n">app_counts</span> <span class="o">=</span> <span class="n">user_apps</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'app_id'</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">'is_active'</span> <span class="p">:</span> <span class="nb">sum</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">active_apps</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">app_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">app_counts</span><span class="o">.</span><span class="n">is_active</span> <span class="o">>=</span> <span class="n">min_sup</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_apps</span> <span class="o">=</span> <span class="n">user_apps</span><span class="p">[</span><span class="n">user_apps</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">'app_id'</span><span class="p">]</span> <span class="ow">in</span> <span class="n">active_apps</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_apps</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[18]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(342708, 4)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Construct-Transaction-DataFrame">Construct Transaction DataFrame<a class="anchor-link" href="#Construct-Transaction-DataFrame">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Constructing the Transaction DataFrame involves merging all rows in the "unrolled" dataset corresponding to a single User / Device ID.  Application IDs in the resulting set correspond to the union of installed Applications across all sample points in the data for the specified User.</p>
<p>Analyzing the total number of installed, active applications for each User, we notice that most users only have a handful of applications active across the sample points.  Most Users have less than 30 active applications overall, while some "super Users" have upwards of 100 active application.</p>
<p>The "Super Users" seem a bit exceptional in comparison to most Users.  Thus, we restrict the dataset to include only those users with less than 40 unique active applications in their corresponding transaction.  This corresponds to about 95% of the total User base in the current dataset.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Generate the application list, hash table</span>
<span class="n">apps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">user_apps</span><span class="o">.</span><span class="n">app_id</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">apps_hash</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">apps</span><span class="p">)}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Construct the user : apps (transaction : items) table</span>
<span class="c1"># Replace actual application ids with the hash key</span>
<span class="n">trans_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">user</span><span class="p">,</span><span class="n">group</span> <span class="ow">in</span> <span class="n">user_apps</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'device_id'</span><span class="p">]):</span>
    <span class="n">curr_apps</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s1">'app_id'</span><span class="p">])</span>
    <span class="n">curr_apps</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">apps_hash</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">curr_apps</span><span class="p">])</span>
    <span class="n">trans_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">'user'</span> <span class="p">:</span> <span class="n">user</span><span class="p">,</span>
                       <span class="s1">'apps'</span> <span class="p">:</span> <span class="n">curr_apps</span><span class="p">})</span>
<span class="n">trans_list</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">trans_list</span><span class="p">)</span>
<span class="n">trans_list</span><span class="p">[</span><span class="s1">'length'</span><span class="p">]</span> <span class="o">=</span> <span class="n">trans_list</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'apps'</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trans_list</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[21]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>apps</th>
<th>user</th>
<th>length</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>{1592, 1962, 14, 2430, 1060, 777, 595, 417, 19...</td>
<td>-9222956879900151005</td>
<td>55</td>
</tr>
<tr>
<th>1</th>
<td>{40, 390, 105, 18, 336, 266, 214, 464, 17, 210...</td>
<td>-9221026417907250887</td>
<td>29</td>
</tr>
<tr>
<th>2</th>
<td>{83, 98, 38, 1420, 70}</td>
<td>-9220830859283101130</td>
<td>5</td>
</tr>
<tr>
<th>3</th>
<td>{70, 118, 156, 2616}</td>
<td>-9220061629197656378</td>
<td>4</td>
</tr>
<tr>
<th>4</th>
<td>{2499, 283, 144, 108, 149, 106, 147, 208, 1442...</td>
<td>-9218960997324667698</td>
<td>20</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">trans_list</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
<span class="n">g</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Distribution of Total Applications for Users"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Unique Applications for User'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Count'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAuIAAAH+CAYAAADZH2tCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAIABJREFUeJzs3Xl4VOXd//HPzGSfJEACiUUEcWmi1EAIioAgCRAKshRZ
g8TnEVpbFKzKFnG5XBukImIpig9iQbRsqRh9lCDEugAFDItgpSooWzQbhOyEkPP7gx/zEAgwCZO5
Ib5f1+V1Zc65zznf+c5EPnNyzzk2y7IsAQAAAPAqu+kCAAAAgJ8jgjgAAABgAEEcAAAAMIAgDgAA
ABhAEAcAAAAMIIgDAAAABhDEAbgtJiZGn3322UXvJzs7WzExMdqzZ48kKTo6Wp988slF71eSXnnl
FY0ePdoj+6qrPXv26Ne//rViY2NVWlpqpIbTjR49Wi+++OIlcfzp06crJSXF48doqP1eyLfffqu+
ffsqNjZWFRUVXj8+gMbBx3QBAMxLSEhQbm6uHA6HJCk8PFw333yzxo0bp1/+8peucV9++aVb+zt0
6JC+/PJL9evXr9b1LVu2dHtf7li0aJHuuusu+fj4aPz48Ro/frzH9l0Xy5cvl9PpVFZWluz2muc5
xo0bpy1btshms+nEiROqqqqSv7+/LMuSzWbT6tWr9Ytf/OK8+z969KjWrFmj4cOHe6xmy7LUq1cv
FRUV6fPPP1dAQIDH9n26P/3pTx7ZT3V1tRYvXqz//u//9uh+62rZsmVq2rSpVq9eLZvNdtH7W7Fi
hebMmaPPP//8rHWjR49Wp06d9PDDD1/0cQBcWjgjDkDSyTOLO3bs0NatW/X6668rIiJCw4cPrzUY
XEhGRoY+/PDDBqjybIcPH9aMGTNUWVnpleOdT1FRkVq1anVWCJek119/XV9++aV27NihRx55RFde
eaV27NjhWnahEC5J69ev18qVKz1a8/r162Wz2dS2bVutXr3ao/tuCDt37tSCBQtMl+F6rT0RwgH8
fBHEAUg6eWZUkhwOh9q2batJkybpd7/7nR577DGdOHFCUs0pJJ988ol+85vfKDY2Vt26ddOTTz6p
yspKvfbaa3rhhRe0du1atW/fXsePH1dycrJmzpypIUOG6J577tGhQ4cUHR2t7777znX8gwcPavTo
0YqNjdXQoUO1e/duSdLmzZsVHR2t8vJy19hHHnlEf/zjH5WTk6MePXpIkrp06aKVK1dq7ty5Gjp0
qGvstm3bNGrUKMXFxem2227Tc889p6qqKknSO++8o0GDBundd99VQkKC4uLiNGXKFJ3rhsOVlZWa
MWOGEhIS1KFDB40cOVJffPGFJGnatGl699139dFHH6l9+/YqKSmp1+uwbNky3XHHHerQoYP69u2r
FStWSJLeffddTZkyRTt37lT79u118OBBHTt2TI8//ri6d++uuLg4jRw5ss5/aVixYoXuuOMO9e/f
33Ws09f17dtXK1euVI8ePRQbG1vj/TBlyhQ9+uijeuaZZ9SpUyd16dJFb731Vq3HmTJliiZNmuR6
vGrVKv36179Wx44dNWrUKO3atcu17m9/+5tr2kffvn21atUqSdIXX3yhu+66SwUFBWrfvr02b958
1n7Xrl3rel8mJCRo/vz5rnUvvfSSJk6cqNdee03dunVT586dNWvWLNf6zMxMDR48WLGxsbrtttv0
9NNP6/jx42c9l0mTJun999/Xhx9+qPbt26uiokI5OTm6//771aVLF3Xq1EkTJkxQbm6uJGn//v2K
jo7W3//+d3Xu3Fnvvfee26/PmfLy8nT//ferc+fOiouLU3Jysr755hvX+g8++MD1/Hv37l3j9Zgy
ZYoee+wx3X333brjjjskSStXrnT1umfPnvrLX/5S79oA1IMF4GcvPj7eWrJkyVnLjx49at1www3W
5s2bLcuyrKioKOuf//yndfz4catDhw5WWlqaZVmWlZubaw0dOtR6++23LcuyrJSUFOuBBx5w7WfM
mDHW7bffbu3YscOyLMs6ePCgFR0dbX377beu/fbv39/69ttvrfLycmvatGlWQkKCZVmWtWnTJis6
OtoqKytz7e/0/Z9aX15eblmWZf3lL3+xhg4dalmWZRUUFFgdOnSwFi1aZFVWVlrfffedlZCQYL38
8suWZVnWP/7xDysuLs565plnrPLycuvrr7+22rVrZ2VmZtbapxkzZlgDBgywDhw4YFVWVlovv/yy
1alTJ6uoqKjW530uS5YscT2/03300UdWbGystWXLFuvEiRPWunXrrHbt2llbtmyxLMuyZs+ebY0c
OdI1/uWXX7YGDBhgFRYWWlVVVdaMGTOs+Ph41/qkpCRr1qxZ56yjoKDAateunfXdd99ZOTk51o03
3mh9//33rvXLly+32rdvbz3xxBPWsWPHrL1791q33XabtXDhQsuyLGvy5MlWp06drBUrVljHjx+3
1q5da91www3Wzp07zzr+5MmTrYcfftiyLMvasWOH1aFDB2vz5s1WVVWV9corr1jdunWzKisrrX/9
61/WTTfdZO3evdvVkxtvvNHav3+/q6Zu3bq5ajx9v//+97+tG2+80froo4+sqqoqKysry+rUqZO1
atUqV/9uvfVWa/78+VZlZaW1du1aKyoqyvruu++sY8eOWe3bt3eNzcnJsYYMGWItW7as1t6dflzL
sqzf/OY31pQpU6zS0lKrsLDQGjt2rPVf//VflmVZ1r59+6yoqCjrwQcftEpLS2vd35nP63Sn9zEl
JcX6/e9/b5WXl1uVlZXW7NmzrVGjRlmWZVnbt2+3OnToYK1fv96qrq62tm7dasXFxVkbN2501Xzr
rbda//znPy3L+r/fw1Pvr71791rx8fHWZ599VmsdADyPM+IAzik0NFRhYWE6cOBAjeXHjh1TZWWl
az5xixYttHLlSiUlJZ1zXzfddJNiYmJcj60zzjoPGjRI1113nQICAvT73/9e2dnZri9zuuPM/UnS
e++9p4iICN19993y9fXVtddeq6SkJH3wwQeuMaWlpXrwwQcVEBCg6OhotWnT5pzHTUtL0+9//3u1
atVKvr6+uu+++1RdXe2RL7BKJ89ODho0SJ06dZLdbldCQoI6d+58zmk+9913n5YtW6YmTZrI4XCo
X79++vHHH3XkyBG3jvfOO+/ol7/8pa699lpFRES4/qpwumPHjumhhx6Sn5+f2rZtq0GDBmndunWu
9VdccYWGDRsmHx8f9erVS+3atVNmZuZ5j7tq1Sp17dpVN998sxwOh8aOHavp06ersrJSnTt31oYN
GxQVFSVJ6t27t3x9ffXvf//7gs8nLS1NXbt2Ve/eveVwONSxY0f169evRv8cDofuvfde+fr6qlev
XvL19dXevXtd7+nAwEBJUkREhP7xj39oxIgRFzzurl27tHv3bqWkpCgoKEhNmjTRhAkTtGnTJh0+
fNg1bsiQIQoKCrrg/s6npKREPj4+8vX1la+vrx588EH9/e9/dz3/hIQEde3aVTabTbGxsRo4cKDe
eecd1/atWrXS7bff7tqXJNdzbtu2rTIzM3XbbbddVI0A3EcQB3BeJ06cOGvOs9Pp1Pjx4zV16lQN
HTpUs2fP1t69e8+7n5YtW553/bXXXuv6uXXr1rIsSzk5OfUvXCenu5y+X0lq06aNDh065HocGhqq
4OBg1+OAgIBar4JRVFSkoqKiGvtzOBy68sordfDgwYuq8/R6r7vuuhrLWrduXaPe0+Xl5WnatGm6
9dZbFRMTo7vuukuS3J4vn5aWpkGDBrkeDxw4UKtWrVJ1dbVrWWhoqJo2bep63LJlS9eUC+lkeDvd
metrs3//frVq1cr12M/PT/3795fT6dTx48f18ssvq2fPnmrfvr1iYmJcIflCDhw4cMH+nfk+PPV6
h4SE6A9/+IMefvhhDRs2TLNnz9b3339/wWNKJ1+3Ux9aT2nTpo0sy1J2dvY5j10fv/vd77R9+3b1
7NlTjzzySI0PRQcOHNDq1avVvn17V+/S0tJq/B6dXkNUVJTuvPNOjRgxQmPGjNGrr7560b9zAOqG
IA7gnE6dXT0z3EjShAkTlJmZqaFDh2rnzp1nnSk906krspzL6V96O3V228/Pr9axp+YoX8i5wtvp
x6rti5V12deZ+7sYdf3C6R//+EeVlpbq3Xff1ZdffqmlS5e6ve0XX3yhvXv36qWXXlJsbKxiY2P1
5JNPqqCgQB9//LFr3Omh/JTTn++Zr4X1/68Ccz52u73W/UrSyy+/rDVr1uiVV15xfZn11BnbC3Gn
f+d7vR944AGtW7dOQ4YM0ZdffqmBAwe6dVlNd98b5/sd8PX1PedlEIuLi+Xv7y/p5CVEMzMz9dRT
T8nHx0dTp051zZH39/dXUlKSduzY4erdl19+qb/97W+uffn41LxY2nPPPacPPvhACQkJyszMVL9+
/fTVV19d8DkD8AyCOIBzmjt3rq655hr96le/OmvdkSNHFBERodGjR2vhwoUaOHDgRV3R4/Szj/v2
7ZPNZtMVV1zhCiCnf1lz//79bu2zdevWZ52p37Nnj1q3bl3n+sLDw+V0OmtMW6msrNShQ4d09dVX
13l/tbnqqqvOmhazd+9etWnTptbxu3bt0siRIxUZGel67K6VK1eqe/fueu+995Senu76r3///jVe
x5KSEhUWFroeHzp0yHU86ezXIjs7u8b62lx11VU1Xu8TJ07ojTfeUF5ennbu3KlevXrphhtukHTy
fVFWVubWc6pr/85UWFioyMhI3XXXXXrjjTfO6sW5tG7dWkVFRSooKHAt27Nnj+x2u6666ipJF/6w
ds0116i0tPSsaWCFhYXat2+fbrzxRkknQ7nD4VBCQoKeeeYZzZ07Vx988IFKSkrUpk0b/ec//6mx
fU5Ozjk/uFqWpaNHj6pNmzYaO3asli9frhtuuOGivkwKoG4I4gDOkpeXp5kzZ+qDDz7Qc889d9b6
7du3q3fv3q4rhhw+fFg//PCDK5D6+/vrxx9/VHFxsdtnr9PT0/XDDz/o2LFjWrBggaKiotSqVSu1
atVKDodDGRkZOnHihP73f/+3Rvg7NU997969NcK6JPXv318//fSTlixZoqqqKu3evVt///vfa1xV
xV02m02DBw/Wa6+9puzsbFVUVGjOnDkKDAz02JzaO++8U+np6dq2bZtOnDih1atXKysrS7/5zW8k
nXyuubm5Onr0qCorK9WqVStt375dVVVV2rhxo9auXStJF5xeUFxcrNWrVyspKUlXXXVVjf+SkpL0
6aefKi8vT9LJv0rMnTtXx44d0549e/Tee++pT58+rn1lZ2crPT1dVVVVWrt2rb7++mv17t37gs9z
8+bN+vjjj1VVVaXFixfr9ddfV2hoqK666ip9/fXXqqio0J49ezRr1ixFRES4nlNAQIBKSkqUm5ur
Y8eO1djvkCFDtGHDBn388cc6ceKENm3apA8//FB33nnnBXv/xRdfqE+fPtq6daukk+/pffv2uRXi
27dvr2uuuUYzZ85UeXm58vPz9Ze//EW9evVSaGiopNq/w3C6mJgYdenSRdOmTdOePXtUXV2tvXv3
atKkSbr55psVHx8vSRo2bJjr9aiqqtLOnTsVHh6u4OBgjRgxQtu2bVNaWpqOHz+ub775RklJSXr/
/fdrPWZ6erqGDBniunrRoUOHlJOT4/YHFwAXjxv6AJAkpaamaubMmbIsS0FBQercubOWL1+u66+/
3jXm1Fm9Dh066OGHH9b06dOVm5urkJAQ9ezZUxMnTpQkDRgwQBkZGYqPj9e7775b69lAm83mWm6z
2ZScnKxp06bpm2++0fXXX++6rFx4eLgmT56suXPn6sUXX9TgwYM1ePBg19zbG264QbGxsUpKSnId
/5Rf/OIX+utf/6qXXnpJL730ksLDw3X33Xe7bgZTm/OduZw6dar+9Kc/KSkpSRUVFbrpppu0ZMkS
t6dOXMgdd9yhn376SSkpKcrPz9fVV1+t+fPnu84O9+nTR0uXLlXPnj31xhtv6Mknn9Tjjz+uZcuW
qXPnznr++ec1efJk3XPPPVq+fPk5n8t7772n4OBg9ezZ86x1nTp1UuvWrfXOO++oWbNmCg0NVVRU
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
9a9/1dKlSzV//nytW7eOftbTO++8o2uuuUaLFy/WnDlz9Nxzz/G7Xkfl5eV69tln1aVLF9ey2t6P
5eXlmjdvnhYtWqTFixdr0aJF3CGyFufq56hRo/Tmm2+qV69eeuONN+inm2rrpyRVVlbqtddeU0RE
hGsc/byw2vq5fPlyhYeHa8WKFerfv7+++OKLOvezUQXxjRs3qnfv3pKka6+9VkVFRSotLTVc1eXl
lltu0Zw5cySdvH1tWVmZtmzZ4rqraXx8vDZs2GCyxMvO3r17tXfvXt1+++2yLEtbtmxRfHy8JPpZ
Vxs2bFC3bt0UGBio5s2b6+mnn9bmzZvpZz00a9ZMR44ckSQdPXpUYWFh/K7Xkb+/vxYsWOAKNJJq
fT/u2LFDMTExcjqd8vf3V8eOHbV161ZTZV+yauvnk08+qcTERElSWFiYCgsL6aebauunJL366qsa
M2aMfH19JYl+uqm2fn788ccaOHCgJGn48OGKj4+vcz8bVRDPz89XWFiY63GzZs1q3JETF2az2RQQ
ECBJWrlypXr27Kny8nLXL2x4eLjy8vJMlnjZef7555WSkuJ6TD/r79ChQyovL9f48eM1ZswYbdy4
URUVFfSzHvr376/s7GwlJiYqOTlZU6dO5b1ZR3a7XX5+fjWWndnD3NxcFRQU1Pi3KSwsjN7WorZ+
BgQEyGazqbq6Wm+//bYGDBhw1r/19LN2tfXz+++/13/+8x/17dvXtYx+uqe2fh46dEiffPKJkpOT
NWnSJB09erTO/WxUQfxMXCK9/tauXau0tDQ9/vjjNfpIT+tm1apVio2N1ZVXXlnrevpZN5Zluaan
pKamavr06bw/6yk9PV0tW7bUmjVrtGjRIj311FM11tPLi3euHtLbuqmurtaUKVPUpUsX3XrrrWet
p5/umzFjhuvEEO/Pi2dZlq699lq9+eabuu666zR//vxax5xPowriERERNc6A5+bmqkWLFgYrujx9
9tlneu2117RgwQIFBwfL6XSqsrJSkpSTk3PWn7lwbp988onWrVvn+sLGvHnzFBQURD/rqXnz5oqN
jZXdbtdVV10lp9PJ+7Oetm7dqu7du0uSoqKilJeXp8DAQHp5kc58P0ZGRioiIqLGGTF6WzePPPKI
2rZtq/vuu0+S6Gc95eTk6Pvvv9eUKVM0cuRI5eXlKTk5WZGRkfSznpo3b66bb75ZknTbbbdpz549
de5nowri3bp1U0ZGhiTpq6++UmRkpIKCggxXdXkpKSnRn//8Z7366qsKCQmRJHXp0sXV14yMDNc/
3riw2bNna8WKFVq2bJmGDRum+++/X126dNHq1asl0c+66tatmzZt2iTLsnTkyBGVlZXRz3pq06aN
tm/fLunkn1edTqe6du1KLy9Sbf+/jImJ0a5du1RSUqLS0lJt27ZNcXFxhiu9PKSnp8vPz08TJkxw
LWvfvj39rIfIyEitWbNGS5cu1bJly9SiRQu9+eabvD8vQo8ePfTpp59KOpk727ZtW+d+Nrpb3L/4
4ovavHmzHA6HnnjiCUVFRZku6bKyfPlyzZ07V1dffbUsy5LNZtPzzz+vRx99VJWVlWrZsqVSU1Pl
cDhMl3rZmTt3rlq1aqXbbrtNU6dOpZ/1tHz5cq1YsUI2m0333XeffvWrX9HPeigrK9P06dNVUFCg
EydO6MEHH1Tbtm01bdo0eummr776SjNmzFB2drZ8fHwUGRmpF154QSkpKWf1cM2aNVqwYIHsdruS
k5N1xx13mC7/klNbPw8fPiw/Pz85nU7ZbDZdd911euKJJ+inG2rr59y5cxUaGipJ6tWrl9atWydJ
9NMNtfVz1qxZevbZZ5WXlyen0/n/2rv/mKjrP4Djz7vj10qgDhSzWqtlwwiRQquV7uDAO1C4k/TW
XNiozVrSZgvBSwaZFTFnwWbMiSWLyDXx4MIOb5ihy7YmkBWWTsnSzvGjg4MVNPK87x+MT1wgaFp8
o9fjLz6fe3/e79d9PvzxutfndZ+jpKQErVZ7Vedz2iXiQgghhBBC/BtMq9YUIYQQQggh/i0kERdC
CCGEEGIKSCIuhBBCCCHEFJBEXAghhBBCiCkgibgQQgghhBBTQBJxIYQQQgghpoAk4kKIacvlchET
EzNmf21tLdnZ2ZMen52dzXffffd3hDaukpISHnzwQTo7O695rqysLOrr6+ns7CQ9Pf0vz3P27Fma
m5sBOHjwIJs2bbrm2CZTXV3No48+Ou7PRV+py11jq9XKjh07riU8IYS4bgKmOgAhhPg7qVSqq9o/
2u7du693OJfl9Xppamri6aefxm63s3bt2usyb1RUFPX19X/5+MbGRrxeLwkJCSQnJ5OcnHxd4pps
zRdeeIHHHnvsmua5kmsshBBTSSriQoj/tO3bt7NlyxZycnJITk7GYrHw888/A5CUlERra6syTqfT
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
eysI6cH8KfMAAAAASUVORK5CYII=
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">trans_list</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[23]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>count</th>
<th>mean</th>
<th>std</th>
<th>min</th>
<th>10%</th>
<th>20%</th>
<th>50%</th>
<th>80%</th>
<th>90%</th>
<th>95%</th>
<th>99%</th>
<th>max</th>
</tr>
</thead>
<tbody>
<tr>
<th>length</th>
<td>23235.0</td>
<td>14.743318</td>
<td>12.91813</td>
<td>1.0</td>
<td>2.0</td>
<td>3.0</td>
<td>11.0</td>
<td>24.0</td>
<td>32.0</td>
<td>39.0</td>
<td>58.0</td>
<td>144.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trans_list</span> <span class="o">=</span> <span class="n">trans_list</span><span class="p">[</span><span class="n">trans_list</span><span class="o">.</span><span class="n">length</span> <span class="o"><=</span> <span class="mi">40</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Take-a-Random-Sample,-Save-for-Later">Take a Random Sample, Save for Later<a class="anchor-link" href="#Take-a-Random-Sample,-Save-for-Later">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Even with the restrictions made up to this point, there remain about 22K transactions.  With this many transactions to check, the full dataset takes awhile to process.  Thus, for the purposes of this article, and general testing, development and comparison, we will obtain a random subset of the data.</p>
<p>This dataset will be used in subsequent posts as well as we construct various parts of the method.  At the end of the process, we will use the full dataset from the previous step.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trans_list</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[25]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(22174, 3)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trans_list</span> <span class="o">=</span> <span class="n">trans_list</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7500</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rnd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trans_list</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[27]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(7500, 3)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cd</span> <span class="n">Dropbox</span><span class="o">/</span><span class="n">Analytics</span><span class="o">/</span><span class="n">Frequent</span>\ <span class="n">Pattern</span>\ <span class="n">Mining</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[Errno 2] No such file or directory: 'Dropbox/Analytics/Frequent Pattern Mining'
/home/immersinn/Dropbox/Analytics/Frequent Pattern Mining
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'transaction_list_subset.pkl'</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">trans_list</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'application_dictionary.pkl'</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">apps_hash</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Implementation:--Part-I">Implementation:  Part I<a class="anchor-link" href="#Implementation:--Part-I">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Background">Background<a class="anchor-link" href="#Background">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Overview of the Apriori property (downward closure) and how it can be utilized for searching for patterns:</p>
<p>Understanding that for any any pattern $B$ such that $A \subseteq B$ cannot be frequent given that $A$ is observed in the dataset less than <em>min_sup</em> is the crux of the Apriori methodology.  Working from singletons (individual applications in our example) upwards, then, we only construct candidate patterns from smaller patterns that have been observed to be frequent in the dataset.</p>
<p>While this is certainly useful in pattern detection, we will see that the number of candidate patterns generated remains extremely large.</p>
<p>To review, the steps in the iterative process are:</p>
<ol>
<li>Generate new candidates for Frequent-<em>k</em> patterns from Frequent-<em>(k-1)</em> patterns using the Apriori property</li>
<li>Find the supports for each of the Frequent-<em>k</em> candidate patterns by iterating over the transaction dataset</li>
<li>Determine which of the candidates have supports that meet the <em>min_sup</em> threshold; these are the Frequent-<em>k</em> itemsets</li>
</ol>
<p>Steps 1-3 are repeated until no Frequent-<em>k</em> itemsets are found.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Start-Finding-Frequent-Itemsets:-Breakdown">Start Finding Frequent Itemsets: Breakdown<a class="anchor-link" href="#Start-Finding-Frequent-Itemsets:-Breakdown">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Find-Frequent-1-Itemsets">Find Frequent-1 Itemsets<a class="anchor-link" href="#Find-Frequent-1-Itemsets">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first thing to do is find all single items in the transactions that are frequent.  These will compose the Frequent-1 itemsets.  Simply counting the number of transactions that each App appears in accomplishes this task.</p>
<p>To formalize, we first generate the set of candidate Frequent-1 patterns, which consists of all the Apps from the App ID lookups from the hash table constructed previously, which was used to create the Transaction Table.  We then count the number of transactions each of these candidates occur in.  Finally, counts are compared to the $min\_sup$ value, and any itemset occurring at least $min\_sup$ times in the dataset is added to the Frequent-1 list.</p>
<p>Three functions (shown below) are used for this task.  Given a transaction and the set of candidates, the function check the transaction for all candidates, and record if a candidate pattern was observed within the transaction.  These are general functions and are applicable for patterns of any length.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">updateCounts</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">curr_counts</span><span class="p">,</span> <span class="n">ret</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">new_items</span> <span class="o">=</span> <span class="n">checkMatches</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">)</span>
    <span class="n">curr_counts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_items</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">curr_counts</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">patternInTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span> <span class="o">==</span> <span class="n">pattern</span><span class="p">)</span>
       
<span class="k">def</span> <span class="nf">checkMatches</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">):</span>
    <span class="n">new_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">pattern</span> <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span> \
                 <span class="k">if</span> <span class="n">patternInTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span>  <span class="n">pattern</span><span class="p">)]</span>
    <span class="n">new_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'-'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ni</span><span class="p">)])</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="n">new_items</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">new_items</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">apps_hash</span><span class="o">.</span><span class="n">values</span><span class="p">())]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>2761
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>

counts = FreqDist()
_ = trans_list.apply(lambda x: updateCounts(x['apps'],
                                            candidates,
                                            counts,
                                            ret=False),
                    axis=1)
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 5.97 s, sys: 0 ns, total: 5.97 s
Wall time: 5.97 s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the DataFrame <em>apply</em> class method, the <em>updateCounts</em> function can be applied to each row in the DataFrame in order to update the "counts" frequency distribution.</p>
<p>After obtaining the counts for each item, we determine which items are Frequent-1 patterns by comparing the counts to the $min_sup$ value.  We observe that about 1400 out of the total 2700 candidates were found to be frequent with support 5.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Set Minimum Support Value</span>
<span class="n">min_sup</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">frequent</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">frequent</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">>=</span> <span class="n">min_sup</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">frequent</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[36]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>1471</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Generate-Frequent-2-Candidates">Generate Frequent-2 Candidates<a class="anchor-link" href="#Generate-Frequent-2-Candidates">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we need to generate the candidates for Frequent-2 patterns.  For Frequent-1 itemsets, this is straightforward.  The Apriori property tells us that every pairwise combination of Frequent-1 itemsets is a Frequent-2 candidate.  The itertools module can be used to easily generate these cnadidates.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_cands</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">combo</span><span class="p">)</span> <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">frequent</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="mi">2</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">new_cands</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[39]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>1081185</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Number of set check matches we need to do</span>
<span class="n">freq_2_ops</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_cands</span><span class="p">)</span> <span class="o">*</span> <span class="n">trans_list</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">freq_2_ops</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>8108887500
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">freq_1_ops</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">*</span> <span class="n">trans_list</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">freq_1_ops</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>20707500
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">freq_2_ops</span> <span class="o">/</span> <span class="n">freq_1_ops</span> <span class="o">*</span> <span class="mf">5.25</span> <span class="o">/</span> <span class="mi">60</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[42]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>34.26428377399493</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One may being to suspect a slight issue with this approach.  The approximately 1400 Frequent-1 itemsets result in about 1 million candidates for Frequent-2 itemsets, which implies that we will be performing about 8 billion set intersections and comparisons to obtain the Frequent-2 itemsets and get the Frequent-3 candidates.</p>
<p>For comparison, note that we performed only about 20 million operations to determine the Frequent-1 patterns, which took about 5 seconds.  Thus, by rough estimates, counting supports for all of the Frequent-2 candidates would take about half an hour on our random data subset.  While this is not a particularly long time in comparison to some processes, it is significantly longer than the sub-six-seconds observed for counting supports for single items.</p>
<p>In the next subsection, we look into using the ipyparallel module for using parallel processing to reduce the processing time.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-ipyparallel-for-Speedup">Using ipyparallel for Speedup<a class="anchor-link" href="#Using-ipyparallel-for-Speedup">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The task at hand is ripe for speed-up from utilizing parallel processing.  Each transaction (pattern) independent of all other transactions (patterns).  Thus by splitting the transactions (patterns) into parts, pattern supports can be checked for each section and finally merged when all sections have been checked.</p>
<p>Below we focus on partitioning the transactions across cores in two ways.  The first method involves splitting the data at every row -- every transaction --, and the second involves chunking the DataFrame into several large sections, each of which is sent off for processing.  The two methods are then compared in terms speed.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Non-Parallel">Non-Parallel<a class="anchor-link" href="#Non-Parallel">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For a baseline measure, each method is first performed sans parallelization.  Two additional functions are introduced as wrappers around the pattern-checking functions introduced earlier.</p>
<p>One function takes a row object and the candidate patterns as an argument, and returns the counts for each candidate pattern in the row's transaction.</p>
<p>The second function -- "section_loop" -- takes a section of the transaction list and the candidate patterns as arguments.  After checking each row in the section for the given set of candidate patterns, the function updates the total candidate pattern counts for the section.  After checking all rows in the section, the total recorded counts are returned.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [43]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">row_loop</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">patterns</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">()</span>
    <span class="n">transaction</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">'apps'</span><span class="p">]</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">updateCounts</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">section_loop</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">patterns</span><span class="p">):</span>
        
    <span class="n">counts</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">()</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">updateCounts</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'apps'</span><span class="p">],</span>
                                             <span class="n">candidates</span><span class="p">,</span>
                                             <span class="n">counts</span><span class="p">,</span>
                                             <span class="n">ret</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Each-row-as-separate-item">Each row as separate item<a class="anchor-link" href="#Each-row-as-separate-item">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>

results_1a = []
for row in trans_list.iterrows():
    # This line submits the tasks for parallel computation.
    results_1a.append(row_loop(row, candidates))
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 7.16 s, sys: 44 ms, total: 7.2 s
Wall time: 7.2 s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_counts_1a</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results_1a</span><span class="p">:</span>
    <span class="n">new_counts_1a</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Sections-of-the-DataFrame-as-Separate-Items">Sections of the DataFrame as Separate Items<a class="anchor-link" href="#Sections-of-the-DataFrame-as-Separate-Items">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>
results_2a = []
n_sections = 8
len_section = trans_list.shape[0] // n_sections
start_cuts = [0 + len_section*i for i in range(n_sections)]

for i, ind in enumerate(start_cuts):
    if i==(n_sections-1):
        section = trans_list[ind:]
    else:
        section = trans_list[ind:start_cuts[i+1]]
        
    results_2a.append(section_loop(section, candidates))
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 5.94 s, sys: 4 ms, total: 5.94 s
Wall time: 5.94 s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_counts_2a</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results_2a</span><span class="p">:</span>
    <span class="n">new_counts_2a</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_counts_1a</span> <span class="o">==</span> <span class="n">new_counts_2a</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[48]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As a sanity check, we ensure that both methods return the same supports for all candidate patterns in the dataset.</p>
<p>The "row loop" method takes over a second longer (about 20% longer) than the "section loop" method, probably because the latter method is able to make use of the built-in DataFrames "apply" class method, which has been optimized for these kinds of operations.  Note that the "section loop" method is comparable in performance to the straight-forward DataFrame "apply" method used originally.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Parallel">Parallel<a class="anchor-link" href="#Parallel">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Updating-the-Loop-Functions">Updating the Loop Functions<a class="anchor-link" href="#Updating-the-Loop-Functions">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For parallel processing, some modifications must be made to the two functions introduced above.  Each spawned process will be created in its own environment.  Thus, the processes will not have any knowledge of content contained within this notebook that is not explicitly passed to the process.</p>
<p>In order for the processes to have access to the original pattern checking methods, they need to somehow be passed.  The most straight-forward way to do this is to embed the functions in the overall loop functions.  Additionally, we need to explicitly import any external modules that are used within any of the methods.  Only the FreqDist class from the nltk module is used, which we import.</p>
<p>An alternative method allowed by ipyparallel is to <a href="https://ipyparallel.readthedocs.io/en/latest/multiengine.html#starting-the-ipython-controller-and-engines">import the necessary modules, functions, and methods into the engine(s) namespace(s) using the views</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">row_loop_parallel</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">patterns</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">nltk</span> <span class="k">import</span> <span class="n">FreqDist</span>
    
    <span class="k">def</span> <span class="nf">updateCounts</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">curr_counts</span><span class="p">):</span>
        <span class="n">new_items</span> <span class="o">=</span> <span class="n">checkMatches</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">)</span>
        <span class="n">curr_counts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_items</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">curr_counts</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">patternInTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span> <span class="o">==</span> <span class="n">pattern</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">checkMatches</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">):</span>
        <span class="n">new_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">pattern</span> <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span> \
                     <span class="k">if</span> <span class="n">patternInTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span>  <span class="n">pattern</span><span class="p">)]</span>
        <span class="n">new_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'-'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ni</span><span class="p">)])</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="n">new_items</span><span class="p">]</span>
        <span class="k">return</span><span class="p">(</span><span class="n">new_items</span><span class="p">)</span>


    <span class="n">counts</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">()</span>
    <span class="n">transaction</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">'apps'</span><span class="p">]</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">updateCounts</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">section_loop_parallel</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">patterns</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">nltk</span> <span class="k">import</span> <span class="n">FreqDist</span>
    
    <span class="k">def</span> <span class="nf">updateCounts</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">curr_counts</span><span class="p">):</span>
        <span class="n">new_items</span> <span class="o">=</span> <span class="n">checkMatches</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">)</span>
        <span class="n">curr_counts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_items</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">curr_counts</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">patternInTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span> <span class="o">==</span> <span class="n">pattern</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">checkMatches</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">patterns</span><span class="p">):</span>
        <span class="n">new_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">pattern</span> <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span> \
                     <span class="k">if</span> <span class="n">patternInTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span>  <span class="n">pattern</span><span class="p">)]</span>
        <span class="n">new_items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'-'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ni</span><span class="p">)])</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="n">new_items</span><span class="p">]</span>
        <span class="k">return</span><span class="p">(</span><span class="n">new_items</span><span class="p">)</span>
    
    
    <span class="n">counts</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">()</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">section</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">updateCounts</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">'apps'</span><span class="p">],</span>
                                             <span class="n">patterns</span><span class="p">,</span>
                                             <span class="n">counts</span><span class="p">),</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Initilizing-the-Client">Initilizing the Client<a class="anchor-link" href="#Initilizing-the-Client">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To utilize ipyparallel, we need to initialize a client that allows us to tap into the multiple cores on the system.  Prior to doing this, however, we need to start ipcluster on the machine.  This <a href="https://ipyparallel.readthedocs.io/en/latest/multiengine.html#starting-the-ipython-controller-and-engines">can be done from a terminal</a>.  While IPython allows issing shell commands from the notebook, in this case the window running the activation command is consumed with running the task.  Thus, running the command in an IPython cell will result in a cell that never "completes" the process.</p>
<p>As a note, various Magic Commands also allow running commands, cells and / or blocks of cells using the parallel engines.  One such example, taken from the <a href="https://ipyparallel.readthedocs.io/en/latest/magics.html#the-magics">ipyparallel help docs</a>, is shown below. We choose to explicitly evoke the engines utilizing a client instead.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [77]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">px</span> --targets ::2
        print('I am even')
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[stdout:0] I am even
[stdout:2] I am even
[stdout:4] I am even
[stdout:6] I am even
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">ipyparallel</span> <span class="k">as</span> <span class="nn">ipp</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [52]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rc</span> <span class="o">=</span> <span class="n">ipp</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rc</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">rc</span><span class="o">.</span><span class="n">load_balanced_view</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[0, 1, 2, 3, 4, 5, 6, 7]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After initializing a client object with the default profile, we create a view instance for the client.  In this case, we choose the LoadBalancedView option (as opposed to the DirectView option), which handles the loads over the engines for us.  That is, subsequent tasks beyond the number of engines are divvied up to engines in an "intelligent" manner.</p>
<p>The integers printed correspond to the engine ids accessible from the client.  In this case, we see that 8 engines are available, each corresponding to a "core".</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Each-row-as-separate-item">Each row as separate item<a class="anchor-link" href="#Each-row-as-separate-item">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [53]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>

async_results = []
for row in trans_list.iterrows():
    # This line submits the tasks for parallel computation.
    ar = view.apply_async(row_loop_parallel, row, candidates)
    async_results.append(ar)

rc.wait(async_results)  # Wait until all tasks are done.
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1min 1s, sys: 2.72 s, total: 1min 4s
Wall time: 1min 7s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [54]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Collect all of the results from teh separate processes</span>
<span class="n">results_1b</span> <span class="o">=</span> <span class="p">[</span><span class="n">ar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">ar</span> <span class="ow">in</span> <span class="n">async_results</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [55]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_counts_1b</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results_1b</span><span class="p">:</span>
    <span class="n">new_counts_1b</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [56]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_counts_1a</span> <span class="o">==</span> <span class="n">new_counts_1b</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[56]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Sections-of-the-DataFrame-as-Separate-Items">Sections of the DataFrame as Separate Items<a class="anchor-link" href="#Sections-of-the-DataFrame-as-Separate-Items">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [57]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>

async_results = []
n_sections = 8
len_section = trans_list.shape[0] // n_sections
start_cuts = [0 + len_section*i for i in range(n_sections)]

for i, ind in enumerate(start_cuts):
    if i==(n_sections-1):
        section = trans_list[ind:]
    else:
        section = trans_list[ind:start_cuts[i+1]]
        
    ar = view.apply_async(section_loop_parallel, section, candidates)
    async_results.append(ar)

rc.wait(async_results)  # Wait until all tasks are done.
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 112 ms, sys: 8 ms, total: 120 ms
Wall time: 1.57 s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [58]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Collect all of the results from teh separate processes</span>
<span class="n">results_2b</span> <span class="o">=</span> <span class="p">[</span><span class="n">ar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">ar</span> <span class="ow">in</span> <span class="n">async_results</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [59]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_counts_2b</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results_2b</span><span class="p">:</span>
    <span class="n">new_counts_2b</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [60]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_counts_2a</span> <span class="o">==</span> <span class="n">new_counts_2b</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[60]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Running the methods again in parallel mode results in fairly surprising results.  The first thing that should stand out is how much longer the "row loop" method took than both of the non-parallel versions and the "section loop" parallel code.  The parallel "row loop" method takes upward of a  minute, or about 9 times <strong><em>longer</em></strong> than the original methods.  Let's consider this for a moment.</p>
<p>Each time a new operation starts on an engine, the environment needs to be prepared.  This includes passing any data and functions required for the task over to the engine.  In the "row loop" case, this happens for every row in the transaction DataFrame, or 7500 times.  Only after the environment is prepped can the engine perform the actual computational task.  In the row loop case, the task is to look for the pattern candidates passed in the single transaction passed.  After the engine processes the transaction, it returns what was found.  Then, a new transaction gets passed along with the candidate data and functions. <em>Etc.</em></p>
<p>For the "section loop" method, however, each engine only has to do the "setup" step once.  Then, it iterates over the rows in the section it was given and returns the result.  Thus, the “section loop” method has significantly less overhead costs than the “row loop” method.</p>
<p>While the "section loop" method performs the fastest so far, it is not as fast as we would expect given that it uses 8 processes instead of just 1.  The method performs only about 4 times faster than the single process methods, which suggests that setup time may still be having an effect on total processing time and / or we're hitting the lower bound of the benefits gained by splitting a task across multiple cores.</p>
<p>Note: we do not expect 8X speedup by going form 1 to 8 cores, as other factors are at play; however, only a 4X speedup seems to imply we have room for improvement.</p>
<p>So, the question remains, are overhead costs associated with “spinning up” engines limiting the potential speedup from parallel processing?  What happens if we only use 6 processes? Or 4, or 2?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Comparing-Performance-for-Varying-n">Comparing Performance for Varying <em>n</em><a class="anchor-link" href="#Comparing-Performance-for-Varying-n">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>While the "timeit" cell or line magic works well for testing the time it takes to run a single line or cell, the goal here is to capture the results for variations in order to compare the results.  To loop over values of "n", we will use the timeit library explicitly.  The results are shown below.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [61]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">parallel_sections_wrapper</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    
    <span class="n">async_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_sections</span> <span class="o">=</span> <span class="n">n</span>
    <span class="n">len_section</span> <span class="o">=</span> <span class="n">trans_list</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">n_sections</span>
    <span class="n">start_cuts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="o">+</span> <span class="n">len_section</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sections</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">start_cuts</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="p">(</span><span class="n">n_sections</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">section</span> <span class="o">=</span> <span class="n">trans_list</span><span class="p">[</span><span class="n">ind</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">section</span> <span class="o">=</span> <span class="n">trans_list</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">start_cuts</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>

        <span class="n">ar</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">section_loop_parallel</span><span class="p">,</span> <span class="n">section</span><span class="p">,</span> <span class="n">candidates</span><span class="p">)</span>
        <span class="n">async_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>

    <span class="n">rc</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">async_results</span><span class="p">)</span>  <span class="c1"># Wait until all tasks are done.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [62]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">timeit</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [63]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">times</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="s1">'parallel_sections_wrapper('</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span> 
                         <span class="n">setup</span> <span class="o">=</span> <span class="s2">"from __main__ import parallel_sections_wrapper, trans_list, candidates"</span><span class="p">,</span>
                         <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">times</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [64]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">times_min</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">'n_engines'</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span>
                               <span class="s1">'min_time'</span> <span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">v</span><span class="p">)}</span> \
                              <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">times</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [65]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'n_engines'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'min_time'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">times_min</span><span class="p">);</span>
<span class="n">g</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Min Computation Time Across Number of Processes"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Number of Processes'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Minumum Time (sec)'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
r/j4eH311VfKycnRpk2bJF1fQf3Pf/5j/buTJ09qwYIFt73M8uXLyzCMPK0up0+fVlpamipWrKic
nBxdvnxZlStX1uuvv66VK1eqSJEi2rhxo+k+ewoVKqQJEyZozpw5ea7vjRB786kXb75P3Y2b50K6
vipcrlw5PfLII/Lw8NDBgwet+/64um8v+LrivmbvNitfvrwyMjJ0+vRp6/6tW7dq586dqlixojIz
M/PMaUZGhi5cuCDp+rxnZWWpfv36ioqK0tKlS7V3714lJSWZ7qtQoUKetiBJunDhgnWl/+LFi/Lz
81NERIRmzJihCRMmOOUsN4ArEJiBfPTMM89o9erVys7OVrVq1fL1stu3b6/w8HA9//zz2rlzp3Jz
c5Wamqq5c+dq9uzZevrppyVd781cvXq19uzZo5ycHG3cuFG7du3SM8884/BYf1zJWrJkic6ePavU
1FQtWLBAjRs3lre3typWrKiMjAxt3bpV2dnZmj9/fp6VMh8fH6Wlpen06dPKyMhQ+fLltX//fl27
dk0HDhzQ4sWL5ePjYw0BPj4+OnfunFJSUm5ZccuP6+Us3bt31+LFi5WYmKjc3FwlJCSoffv2t31L
/+uvv5aXl5c6d+6s8uXLW/899thjioiIsJ6xpEuXLoqLi9OhQ4eUnp6u999/3+b5twMCAtSkSRP9
/e9/18WLF3XlyhXNmDFDlStXVtWqVRUbG6vevXtbQ+3hw4eVkpKiChUqmO5zRI0aNdShQ4c8vawB
AQEqWrSoNmzYoNzcXH333XdKTEy8kym9xb59+7Rjxw7l5ORo2bJlSk1NVZMmTVSkSBG1b99e7733
nk6ePKnMzEzNnDlTffr0sd6v7fVTu+K+Zu82Cw4OVpUqVfTBBx8oLS1Nhw4d0ujRo5WamqrHH39c
tWvXVnR0tC5cuKArV65o0qRJGjRokKTrrRPjx4+3tkHt3btX3t7eKleunOm+Dh066MqVK5o1a5Yy
MjJ08uRJvfzyy5o7d64yMzPVunVrLVq0SNeuXVNmZqb279/vli9ggfxASwZwj25erapcubJKlCjh
8FvxdzrOxx9/rNjYWEVHR+vUqVPy9/dXzZo1tXDhQlWpUkXS9ZXo5ORkRUVF6ezZs6pYsaI++uij
Owrwf1yB69ixo1588UUdPXpU1apV07Rp0yRJVatW1QsvvKC3335bhQoVUt++ffP0MNavX18VKlRQ
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
ztAOlf9oyQCAO8ATEeA6PP7gKgRmAAAAwASBGQAAADBBYAYAAABMEJgBAAAAEwRmAAAAwASBGQAA
ADBBYAYAAABMEJgBAAAAEwRmAAAAwASBGQAAADBBYAYAAABMEJgBAAAAEwRmAAAAwASBGQAAADBB
YAYAAABMEJgBAAAAEwRmAAAAwASBGQAAADBBYAYAAABMEJgBAAAAEwRmAAAAwASBGQAAADBBYAYA
AABMEJgBAAAAEwRmAAAAwASBGQAAADBBYAYAAABMOC0w//LLL2rZsqUWLlzorCEBAACAe+aUwJye
nq7o6GjVr1/fGcMBAAAA+cYpgdnHx0fz589XmTJlnDEcAAAAkG+cEpgLFSokb29vZwwFAAAA5CuL
YRiGswaLiYlRyZIl1bNnT9PjEhMTnVQRAAAAHmS1a9e2e4ynE+q4K44U/6BLTExknhzEXDmGeXIM
8+Q45soxzJPjmCvHME+OcXSRltPKAQAAACacssJ84MABTZ06VSdPnpSnp6fWr1+vmJgYFStWzBnD
AwAAAHfNKYG5atWq+uyzz5wxFAAAAJCvaMkAAAAATBCYAQAAABMEZgAAAMAEgRkAAAAwQWAGAAAA
TBCYAQAAABMEZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAAABMEZgAAAMAEgRkAAAAwQWAGAAAATBCY
AQAAABMEZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAAABMEZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAA
ABMEZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAAABMEZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAAABME
ZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAAABMEZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAAABMEZgAA
AMAEgRkAAAAwQWAGAAAATBCYAQAAABMEZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAAABMEZgAAAMAE
gRkAAAAwQWAGAAAATBCYAQAAABMEZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAAABMEZgAAAMAEgRkA
AAAwQWAGAAAATBCYAQAAABMEZgAAAMAEgRkAAAAwQWAGAAAATBCYAQAAABMEZgAAAMAEgRkAAAAw
QWAGAAAATBCYAQAAABOezhro3Xff1b59+2SxWBQVFaXq1as7a2gAAADgrjklMO/evVu///674uLi
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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We observe that the minimum run times bottom out after 4 cores.  All minimum times recorded for 4 - 8 engines are about the same (i.e. about 1.5 seconds).  Thus, it seems that we are hitting a trade-off between setup time and reduced computation time for tasks of the current size.</p>
<p>Why do we use the minimum value recorded for a value of $n$ and not the mean?  From the <a href="https://docs.python.org/2/library/timeit.html">python help docs</a>:</p>
<blockquote><p><strong>Note:</strong> It’s tempting to calculate mean and standard deviation from the result vector and report these. However, this is not very useful. In a typical case, the lowest value gives a lower bound for how fast your machine can run the given code snippet; higher values in the result vector are typically not caused by variability in Python’s speed, but by other processes interfering with your timing accuracy. So the min() of the result is probably the only number you should be interested in. After that, you should look at the entire vector and apply common sense rather than statistics.</p>
</blockquote>
<p>The time difference results between 4 and 8 cores are not significant enough to compel us to use only 4 engines, especially given that larger datasets will likely have comparable setup times but significantly more computations.  For the remainder of these exercises, then, we will continue to use 8 engines unless evidence arises that convinces us to do otherwise.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Finding-Frequent-2-Itemsets">Finding Frequent-2 Itemsets<a class="anchor-link" href="#Finding-Frequent-2-Itemsets">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With our parallel method in hand, we now progress to counting the supports for all Frequent-2 candidates.  Note that this process takes a bit over 8 minutes, which is in line with expectations.  The non-parallel version was estimated to take around 30 minutes.  A speedup factor of about 4 was observed for counting the supports for Frequent-1 candidates.  Thus, 9 minutes is in line with what we expect, but perhaps a bit slower.  This is likely due to the slightly more complicated patterns being searched for in the transactions.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [66]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>

async_results = []
n_sections = 8
len_section = trans_list.shape[0] // n_sections
start_cuts = [0 + len_section*i for i in range(n_sections)]

for i, ind in enumerate(start_cuts):
    
    if i==(n_sections-1):
        section = trans_list[ind:]
    else:
        section = trans_list[ind:start_cuts[i+1]]
        
    ar = view.apply_async(section_loop_parallel, section, new_cands)
    async_results.append(ar)

rc.wait(async_results)  # Wait until all tasks are done.
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 26.1 s, sys: 1.04 s, total: 27.1 s
Wall time: 9min 11s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [67]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Collect all of the results from teh separate processes</span>
<span class="n">results_freq2</span> <span class="o">=</span> <span class="p">[</span><span class="n">ar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">ar</span> <span class="ow">in</span> <span class="n">async_results</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [68]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">counts_freq2</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results_freq2</span><span class="p">:</span>
    <span class="n">counts_freq2</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Filtering out items that did not occur a sufficient number of times in the transaction dataset, we see that about 32,000 itemsets are in the Frequent-2 patterns.  This constitutes only 3% of the total candidates, but is still about a factor of 20 larger than the Frequent-1 itemsets!</p>
<p>In order to move forward with the pattern mining process, we now need to devise a general method for constructing Frequent-$k$ itemset candidates from the Frequent-($k-1$) itemsets.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [69]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">frequent</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">counts_freq2</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">>=</span> <span class="n">min_sup</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [70]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"A total of </span><span class="si">{0}</span><span class="s2"> Frequent-2 candidates were found to be frequent."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">frequent</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>A total of 31692 Frequent-2 candidates were found to be frequent.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [71]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"The Frequent-2 patterns represent only </span><span class="si">{0:0.1f}% o</span><span class="s2">f the total candidates."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">frequent</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_cands</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>The Frequent-2 patterns represent only 2.9% of the total candidates.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generating-Frequent-3-(and-beyond)-Candidate-Itemsets">Generating Frequent-3 (and beyond) Candidate Itemsets<a class="anchor-link" href="#Generating-Frequent-3-(and-beyond)-Candidate-Itemsets">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this section, we build a general function for generating new Frequent-<em>k</em> candidates from Frequent-(<em>k</em>-1) itemsets.  An outline of the algorithm is as follows:</p>
<ol>
<li>Collect all itemsets starting with the same k-2 items<ul>
<li>This means collect all items sharing every item except for the last item (i.e., a common "head" of length <em>k</em>-2)</li>
</ul>
</li>
<li>Pairwise join all items that share the same "head" in Step 1<br>
+In practice, this can mean, for each "head" in Step 1:<ol>
<li>Generate all of the 2-item combinations of the last items associated with the head to create a set of "tails"</li>
<li>Append each new tail in turn to the head to generate a candidate</li>
</ol>
</br></li>
<li>Remove new candidates whose last k-2 items are not an element of the frequent k-1 dataset</li>
</ol>
<p>Our implementation utilizes default dictionaries for the "head" lookup hash table.  We also generate an additional dictionary to make Step 3 easier.</p>
<p>The "tail lookup" hash table's keys are Frequent-1 itemsets that appear as the last item of a Frequent-(<em>k</em>-1) itemset.  Because of how we order items in itemsets and how new candidates are generated, very Frequent-<em>k</em> candidate item generated must end with an item that is the last item in a Frequent-(<em>k</em>-1) itemset.  Associated with each of these keys is the set -- a Python set object -- of all Frequent-(<em>k</em>-1) itemsets for with the item is the last item.  When performing Step 3 for a particular candidate, we find the set corresponding to the last item in the candidate, and check if the tail of the candidate (the itemset corresponding to the last (<em>k</em>-1) items in the candidate) is a member of this set.  If it is, then the new candidate is valid in terms of the Apriori Property.  Otherwise, it is discarded because a subset of the candidate is not frequent in the transaction dataset.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [72]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">generateCandidates</span><span class="p">(</span><span class="n">frequent_k1_items</span><span class="p">):</span>
    
    <span class="c1"># Map items in "freq" with all but last item matching</span>
    <span class="c1"># to the same list in the hash table</span>
    <span class="n">matchup_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">endwith_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">frequent_k1_items</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'-'</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">'-'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">n</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">matchup_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">endwith_dict</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="n">item</span><span class="p">])</span>
        
    <span class="c1"># For each key in the hash list, construct new candidates</span>
    <span class="c1"># by iterating overall pairwise combination of the corresponding</span>
    <span class="c1"># values.  Merge each pairwise combo with the key to create </span>
    <span class="c1"># a new candidate.  Check if the pattern consisting of the</span>
    <span class="c1"># last k-1 items in the candidate itemset constitute a</span>
    <span class="c1"># frequent pattern in the k-1 Frequent itemsets.  If yes,</span>
    <span class="c1"># add as a candidate pattern.</span>
    <span class="n">ncs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">matchup_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">tail</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">last</span> <span class="o">=</span> <span class="n">tail</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="s1">'-'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
            <span class="n">cand</span> <span class="o">=</span> <span class="s1">'-'</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="n">tail</span><span class="p">])</span>
            <span class="n">test</span> <span class="o">=</span> <span class="s1">'-'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cand</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'-'</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="k">if</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">endwith_dict</span><span class="p">[</span><span class="n">last</span><span class="p">]:</span>
                <span class="n">ncs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cand</span><span class="p">)</span>
                
    <span class="k">return</span><span class="p">(</span><span class="n">ncs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [73]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f2_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">frequent</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [74]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_cands_3</span> <span class="o">=</span> <span class="n">generateCandidates</span><span class="p">(</span><span class="n">f2_items</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [75]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">new_cands_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[75]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>387748</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [76]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">new_cands</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[76]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>1081185</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We observe that the pool of candidates for Frequent-3 patterns are significantly smaller than the pool of candidates for the Frequent-2 itemsets.  Given previous performances, we would expect that calculating the supports for these candidates would take about 2 minutes.  We will leave this task -- and the task of completing the full process on the dataset -- to the next article.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this notebook, we covered some of the preliminaries for carrying out Frequent Pattern Mining (FPM) using only the Apriori Principle.</p>
<p>We first introduced the Apriori Principle that was utilized throughout the post, and outlined how the principle would be used for finding patterns in the transactions.</p>
<p>Next, an overview of the dataset we will be using for the remainder of the FPM examples was provided.  The Kaggle Talking Data dataset was restricted to only active applications that occurred at least $min_sup$ times in the reduced dataset.  Then, we covered converting the dataset to a transaction list so that patterns could be mined.</p>
<p>Then we began writing the necessary functions for counting supports for itemsets and creating new candidate itemsets based on the Apriori Principle.  After finding the Frequent-1 itemsets and generating the candidate patters for Frequent-2 itemset, we realized that the support counting problem had grown significantly.</p>
<p>Due to the large number of candidate patterns generated, parallel processing was investigated.  From our trials, we observed that parallelizing by splitting the transaction list into sections and passing each section to an engine for candidate pattern counting showed the most significant speedup.  Additionally, we decided that using 8 engines would likely provide the largest benefit moving forward.</p>
<p>Finally, we created a general function for generating Frequent-<em>k</em> itemset candidates from Frequent-(<em>k</em>-1) itemsets.  This was the final step needed for implementing the full Frequent Pattern Mining process.</p>
<p>In the next section, we clean up and merge the code from above in order to implement the full method on the dataset and look into the patterns we discover.</p>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  

</article>
        </div><!-- /content -->

    </div><!--/.container /#main-container -->

    <footer id="site-footer">
 
      <address id="site-colophon">
        <p class="text-center text-muted">
        Site built using <a href="http://getpelican.com/" target="_blank">Pelican</a>
        &nbsp;&bull;&nbsp; Theme based on
        <a href="http://www.voidynullness.net/page/voidy-bootstrap-pelican-theme/"
           target="_blank">VoidyBootstrap</a> by 
        <a href="http://www.robertiwancz.com/"
           target="_blank">RKI</a>  
        </p>
      </address><!-- /colophon  -->
    </footer>


    <!-- javascript -->
   
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>


  </body>
</html>